<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Wiki OS Hardening]]></title><description><![CDATA[Obsidian digital garden]]></description><link>http://github.com/dylang/node-rss</link><image><url>lib\media\favicon.png</url><title>Wiki OS Hardening</title><link></link></image><generator>Webpage HTML Export plugin for Obsidian</generator><lastBuildDate>Sun, 15 Dec 2024 23:16:53 GMT</lastBuildDate><atom:link href="lib\rss.xml" rel="self" type="application/rss+xml"/><pubDate>Sun, 15 Dec 2024 23:16:43 GMT</pubDate><ttl>60</ttl><dc:creator></dc:creator><item><title><![CDATA[R62 - Désactiver les services non nécessaires]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> 
 <br><br>L’objectif de la recommandation R62 est de réduire la surface d’attaque en désactivant ou en supprimant les services inutiles ou non requis. Cela permet de :<br>
<br>Limiter les opportunités d’exploitation par des attaquants.
<br>Réduire la complexité de gestion et les vecteurs potentiels d’intrusion.
<br>Diminuer l’impact des vulnérabilités sur les services inutilisés.
<br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>principe associé: <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>Voici la méthode utilisé pour mettre en place cette règle.<br>
Afin de visualiser les différents services disponibles sur votre machine, effectuer la commande suivante:<br>systemctl list-units --type service
<br>Une fois la liste des services analyser, vous pouvez désactiver les services qui ne sont pas utiles à votre machine. (ex: Dbus)<br>
La première commande vous permet de désactiver le démarrage automatique du programme<br>sudo systemctl disable programme.xxx
<br>Tandis que la deuxième permet de stopper le programme si celui-ci est en cours d'utilisation.<br>sudo systemctl stop programme.xxx
<br>Il est possible de supprimer les packages inutiles<br>sudo apt remove --purge nom_du_paquet
<br>Nettoyez les paquets inutilisés après suppression<br>sudo apt autoremove
sudo apt autoclean
<br><br>Désactiver ou supprimer les services inutiles est une étape essentielle pour sécuriser un système. Cette pratique réduit la surface d’attaque tout en simplifiant la gestion. Cependant, chaque modification doit être validée pour s’assurer qu’elle n’interfère pas avec le fonctionnement du système ou des applications dépendantes. Une supervision continue garantit que de nouveaux services inutiles ne sont pas ajoutés accidentellement.]]></description><link>wiki\configuration-des-services\r62-désactiver-les-services-non-nécessaires.html</link><guid isPermaLink="false">Wiki/Configuration des services/R62 - Désactiver les services non nécessaires.md</guid><pubDate>Sun, 15 Dec 2024 21:09:41 GMT</pubDate></item><item><title><![CDATA[R63 - Désactiver les fonctionnalités des services non essentielles]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> 
 <br><br>L’objectif de la recommandation R63 est de réduire la surface d’attaque en limitant les fonctionnalités actives des services démarrés au strict nécessaire. Cela permet de :<br>
<br>Minimiser les vecteurs d'attaque en désactivant les fonctions inutilisées.
<br>Réduire les risques d'exploitation de vulnérabilités associées à des fonctionnalités non essentielles.
<br>Simplifier la configuration et le fonctionnement des services actifs.
<br><br>
<br>niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>principe associé - <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>Voici la méthode utilisé pour mettre en place cette règle.<br>
Afin de visualiser les différentes fonctionnalitées actives, il faut rechercher les fichiers exécutables liés à ces Linux capabilities<br>find / -type f -perm /111 -exec getcap {} \; 2&gt;/dev/null
<br>une fois cela fait, il faut se rendre dans les fichier de configuration des services dont il faut limiter les fonctionnalités. (Ex: SSH ne doit être accéder que via des clés SSH).<br><br>Cette règle est complémentaire à la Règle 62, en désactivant des services ceux-ci non donc pas de fonctionnalités à désactiver, mais certains services essentiels, ont eux besoin d'avoir leur fonctionnalité limité. ]]></description><link>wiki\configuration-des-services\r63-désactiver-les-fonctionnalités-des-services-non-essentielles.html</link><guid isPermaLink="false">Wiki/Configuration des services/R63 - Désactiver les fonctionnalités des services non essentielles.md</guid><pubDate>Sun, 15 Dec 2024 21:09:44 GMT</pubDate></item><item><title><![CDATA[R67 - Sécurisé les authentifications par PAM]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> 
 <br><br>L'objectif de sécuriser les authentifications via une application distante.<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 
<br>principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>Dans un premier temps, il est recommandé de modifier la configuration de complexité des mots de passe. Pour cela, il faut ce rendre dans le répertoire etc.<br>cd /etc
<br>Une fois dans ce répertoire, il faut modifier le fichier pam.d/passwd<br>nano pam.d/passwd
<br>Une fois dans le fichier, il est possible d'ajouter les lignes suivantes afin d'avoir des mots de passe ayant 12 caractères <br>password required pamwquality.so minlen=12 minclass=3 \
                dcredit=0 ucredit=0 lcredit=0 \
                ocredit=0 maxrepeat=1
<br>Une fois la complexité des mots de passe modifiée, il est recommandé de bloquer les comptes ne réussissant pas à rentrer le bon mot de passe après un certains nombre de tentative.<br>
Pour ce faire il faut ce rendre dans les fichiers suivants<br>nano pam.d/login
<br>et<br>nano pam.d/sshd
<br>Une fois à l'intérieur, il est possible d'ajouter le texte suivant<br>auth required pam_faillock.so deny=3 unlock_time=300
<br><br>Pour cette mesure, il est possible d'avoir d'autres modifications via le PAM. En effet, il est possible de restreindre l'accès sur des plages horaires, de restreindre l'accès à des groupes d'utilisateurs ou encore de fournir des répertoires temporaires privés par utilisateur sous /tmp.<br>
Enfin pour ce qui est du temps renseigné en exemple plus haut, il est possible de le changer si jamais la durée de blocage ne vous convient pas.]]></description><link>wiki\configuration-des-services\r67-sécurisé-les-authentifications-par-pam.html</link><guid isPermaLink="false">Wiki/Configuration des services/R67 - Sécurisé les authentifications par PAM.md</guid><pubDate>Sun, 15 Dec 2024 21:09:40 GMT</pubDate></item><item><title><![CDATA[R68 - Protéger les mots de passe stockés]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> 
 <br><br>L'objectif est de protéger les mot de passe contenu dans la machine<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>principe associé - <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>Afin de mettre en place une protection pour les mots de passe. Il faut dans un  premier temps installer le module PAM si celui-ci est disponible pour votre PC<br>sudo apt install libpam-pwquality
<br>Une fois cette partie installée, il ajouter la commande suivante dans le fichier /etc/pam.d/common-password:<br>password required pam_unix.so obscure yescrypt rounds =11
<br><br>Protéger les mots de passe est quelque chose d'important afin d'éviter une prise de pouvoir sur une machine. Cependant, aujourd'hui il exitse aussi des gestionnaire de mots de passes qui peuvent permettre de simplifier cette partie.]]></description><link>wiki\configuration-des-services\r68-protéger-les-mots-de-passe-stockés.html</link><guid isPermaLink="false">Wiki/Configuration des services/R68 - Protéger les mots de passe stockés.md</guid><pubDate>Sun, 15 Dec 2024 21:10:36 GMT</pubDate></item><item><title><![CDATA[R70 - Séparer les comptes systèmes et d'administrateur de l'annuaire]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> 
 <br><br>L'objectif principal de la recommandation 70 de l'ANSSI concernant la séparation des comptes système et d'administrateur de l'annuaire est de renforcer la sécurité du système d'information en appliquant le principe de séparation des privilèges. Voici les buts spécifiques de cette mesure :<br>
<br>Réduire la surface d'attaque en limitant les privilèges accordés à chaque compte.
<br>Empecher qu'une comprommission d'un compte administrateur du système d'exploitation n'entraine automatiquement un accès privilégié à l'annuaire, et vice versa
<br>Améliorer la traçabilité des actions administratives en séparant clairement les rôles et les comptes associés.
<br>Limiter les risques liés à l'utilisation de comptes à hauts privilèges pour des tâches routinières comme l'énumération de comptes.
<br>Faciliter la gestion des droits d'accès en attribuant des privilèges spécifiques à chaque type de compte selon son rôle.
<br>En mettant cette mesure en place, nous cherhcons avant tout à permettre une séparation des droits entre les utilisateurs.<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 
<br>principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>Dans un premier temps, il est nécessaire de faire l'inventaire des comptes existants. Cela se fait avec la commande suivante:<br># Liste des utilisateurs système
cat /etc/passwd

# Liste des groupes
cat /etc/group
<br>S'il n'y a pas deux comptes déjà fait pour les administrateurs, il est possible d'en créer avec la commande suivante<br># Création d'un compte système
sudo useradd -m -s /bin/bash sysadmin_user
<br>Il faut ensuite lui ajouter des droits<br># Ajout d'un utilisateur au groupe sudo (pour les admins système)
sudo usermod -aG sudo sysadmin_user
<br>Par la suite il faut configurer l'énumeration des comptes<br># Création d'un utilisateur dédié pour NSS
sudo useradd -r -s /sbin/nologin nss_enum_user
<br>Si jamais un utilisateur doit être enlevé de la liste des utilisateur administrateur, il faut réaliser la commande suivante:<br># Retrait d'un utilisateur du groupe sudo
sudo gpasswd -d old_admin sudo
<br>Maintenant que la gestion des comptes est réalisée, il faut mettre en place de la surveillance. Cela passe par les commandes suivantes:<br># Configuration de la journalisation avancée (exemple avec auditd)
sudo apt install auditd
sudo auditctl -w /etc/passwd -p wa -k passwd_changes
sudo auditctl -w /etc/group -p wa -k group_changes

# Configuration des alertes (exemple avec fail2ban)
sudo apt install fail2ban
sudo nano /etc/fail2ban/jail.local
]]></description><link>wiki\configuration-des-services\r70-séparer-les-comptes-systèmes-et-d&apos;administrateur-de-l&apos;annuaire.html</link><guid isPermaLink="false">Wiki/Configuration des services/R70 - Séparer les comptes systèmes et d&apos;administrateur de l&apos;annuaire.md</guid><pubDate>Sun, 15 Dec 2024 21:09:37 GMT</pubDate></item><item><title><![CDATA[R74 - Durcir le service de messagerie locale]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> 
 <br><br>La recommandation R74 de l'ANSSI vise à durcir la sécurité du service de messagerie locale pour prévenir les abus et limiter les risques liés à l'exploitation de ce service. Les objectifs spécifiques incluent :<br>
<br>Restreindre l'utilisation du service de messagerie locale aux messages destinés aux comptes utilisateurs locaux.
<br>Empêcher les connexions distantes en limitant le service à l'interface réseau de la boucle locale (localhost).
<br>Réduire la surface d'attaque liée à un service de messagerie mal configuré.
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>principe associé - <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a> 
<br>Lynis - pas d'incident sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>
<br>Vérification du service de messagerie installé<br>
Identifiez le service de messagerie local installé sur la machine (ex. Postfix, Exim, etc.):
<br>dpkg -l | grep -E "postfix|exim|sendmail"
<br>
<br>Configurer Exim pour accepter uniquement les connexions locales
<br>Si Exim est installé, éditez le fichier de configuration : <br>sudo nano /etc/exim4/update-exim4.conf.conf
<br>Modifiez ou ajoutez les paramètres suivants : <br>dc_local_interfaces='127.0.0.1'
dc_other_hostnames='localhost.localdomain'
dc_relay_domains=''
dc_relay_nets=''
<br>Appliquer la nouvelle configuration<br>sudo update-exim4.conf
sudo systemctl reload exim4
<br>
<br>Tester la configuration<br>
Vérifiez que les connexions sont limitées à localhost : 
<br>telnet localhost 25
telnet 127.0.0.1 25
telnet &lt;votre_adresse_ip&gt; 25
<br>
<br>Surveiller l'activité du service de messagerie<br>
Configurez la journalisation pour détecter toute tentative non autorisée : 
<br>sudo tail -f /var/log/mail.log
<br><br>En appliquant ces configurations, le service de messagerie locale est limité à l'interface de boucle locale et n'accepte que les messages pour les comptes locaux. Cela réduit les risques d'abus, comme le relais de spam ou les attaques ciblant des services de messagerie exposés.]]></description><link>wiki\configuration-des-services\r74-durcir-le-service-de-messagerie-locale.html</link><guid isPermaLink="false">Wiki/Configuration des services/R74 - Durcir le service de messagerie locale.md</guid><pubDate>Sun, 15 Dec 2024 21:09:34 GMT</pubDate></item><item><title><![CDATA[R75 - Configurarer un Alias de messagerie des comptes de service]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Veille_et_maintenance" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Veille_et_maintenance</a> 
 <br><br>L'objectif de cette recommandation est d'assurer une surveillance efficace des notifications et rapports générés par les services système et le compte administrateur (root). En configurant des alias de messagerie, les messages importants sont redirigés vers un ou plusieurs administrateurs responsables, permettant ainsi une réponse rapide en cas de problème ou d'alerte.<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 
<br>principe associé - <a href=".?query=tag:Veille_et_maintenance" class="tag" target="_blank" rel="noopener nofollow">#Veille_et_maintenance</a>
<br>lynis - pas d'incident sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br>
<br>Vérifier la configuration existante<br>
Consultez le fichier d'alias de messagerie pour vérifier si des redirections sont déjà définies : 
<br>sudo nano /etc/aliases
<br>
<br>Configurer un alias pour le compte root<br>
Ajoutez une redirection des messages envoyés à root vers un ou plusieurs administrateurs :
<br>root: admin_user1, admin_user2@example.com
<br>Si un service particulier doit également rediriger ses messages, ajoutez un alias similaire : <br>service_account: admin_user1
<br>
<br>Mettre à jour la base des alias<br>
Une fois les modifications effectuées, appliquez-les en mettant à jour la base des alias:
<br>sudo newaliases
<br>
<br>Tester la configuration<br>
Envoyez un email de test pour confirmer que les redirections fonctionnent correctement :
<br>echo "Test message" | mail -s "Alias Test" root
<br>Vérifiez que le message est bien reçu par les administrateurs configurés.<br>
<br>Configurer la messagerie locale si nécessaire<br>
Assurez-vous qu'un service de messagerie local comme Postfix ou Exim est correctement configuré pour traiter les emails. Par exemple, pour exim : 
<br>sudo systemctl start exim4
sudo systemctl enable exim4
<br>
<br>Surveiller les alias et messages<br>
Consultez les journaux pour surveiller l'envoi et la réception des emails générés par le système : 
<br>sudo tail -f /var/log/mail.log
<br><br>La configuration des alias pour les comptes root et les services garantit qu'aucune notification critique n'est perdue, même si le compte d'origine n'est pas régulièrement surveillé. Cette mesure s'inscrit dans une démarche proactive de gestion et de suivi des incidents système. Elle peut être combinée à des outils de supervision pour une gestion encore plus efficace.]]></description><link>wiki\configuration-des-services\r75-configurarer-un-alias-de-messagerie-des-comptes-de-service.html</link><guid isPermaLink="false">Wiki/Configuration des services/R75 - Configurarer un Alias de messagerie des comptes de service.md</guid><pubDate>Sun, 15 Dec 2024 23:01:26 GMT</pubDate></item><item><title><![CDATA[R79 - Durcir et surveiller les services exposés]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> 
 <br><br>La recommandation R79 de l'ANSSI vise à protéger les services exposés à des flux non maîtrisés en durcissant leur configuration et en mettant en place une surveillance proactive. Les objectifs incluent :<br>
<br>Réduire la surface d'attaque en renforçant la configuration des services exposés.
<br>Détecter et signaler rapidement tout comportement anormal des services.
<br>Assurer une conformité stricte avec le fonctionnement nominal prévu des services, tel que défini par leurs spécifications.
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>principe associé - <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>lynis - Incident important sur la notation (+3)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br><br>Listez les services actifs et identifiez ceux accessibles depuis l'extérieur : <br>sudo ss -tuln
<br>Analyser les ports exposés : <br>
<br>Les ports marqués avec 0.0.0.0 ou :: sont accessible depuis l'exterieur
<br>Assurez vous que seuls les services nécessaires ne soient actifs
<br><br>Configurez chaque service pour limiter son exposition et renforcer sa sécurité. Par exemple : <br>
<br>SSH : Limitez les connexions à des utilisateurs et adresses IP spécifiques.
<br>sudo nano /etc/ssh/sshd_config
<br>avec les paremètres suivants qui sont recommandés<br>PermitRootLogin no
AllowUsers utilisateur1
PasswordAuthentication no
UsePAM yes
MaxAuthTries 3
<br>Appliquez les modifications : <br>sudo systemctl reload sshd
<br>
<br>
Web serveur (Nginx/Apache) : Activez des politiques strictes, comme l'utilisation du chiffrement (TLS), et désactivez les modules inutiles.

<br>
Base de données (MySQL/PostgreSQL) : Configurez pour n'accepter que les connexions locales ou sécurisées.<br>
Exemple pour MySQL : 

<br>sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf
<br>Modifiez pour : <br>bind-address = 127.0.0.1
<br><br>Activez et configurez la journalisation des accès et erreurs pour tous les services exposés:<br>
<br>Pour SSH :
<br>sudo nano /etc/rsyslog.d/50-default.conf
<br>Ajoutez:<br>auth,authpriv.* /var/log/ssh.log
<br>Redémarrez rsyslog:<br>sudo systemctl restart rsyslog
<br><br>
<br>Surveillance des logs avec auditd:<br>
Installez et configurer auditd
<br>sudo apt install auditd
sudo auditctl -w /etc/ssh/sshd_config -p wa -k ssh_changes
<br>
<br>Detection d'anomalie avec fail2ban:<br>
Installez et configurez
<br>sudo apt install fail2ban
sudo nano /etc/fail2ban/jail.local
<br>Exemple pour SSH<br>[sshd]
enabled = true
port = 22
logpath = /var/log/auth.log
maxretry = 3
<br>Redémarrez Fail2Ban:<br>sudo systemctl restart fail2ban
<br><br>Cette recommandation demande une approche continue : durcissement initial, surveillance active et adaptation régulière en cas de changements d'exposition ou de comportement des services. En combinant des outils de journalisation, de surveillance comportementale et d'alertes, vous pouvez minimiser les risques liés aux services exposés.]]></description><link>wiki\configuration-des-services\r79-durcir-et-surveiller-les-services-exposés.html</link><guid isPermaLink="false">Wiki/Configuration des services/R79 - Durcir et surveiller les services exposés.md</guid><pubDate>Sun, 15 Dec 2024 21:10:49 GMT</pubDate></item><item><title><![CDATA[R80 - Réduire la surface d'attaque des services réseau]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> 
 <br><br>L'objectif principal de la recommandation R80 de l'ANSSI est de limiter les risques liés aux services réseau en s'assurant qu'ils ne soient accessibles que sur les interfaces réseau nécessaires. Cela permet de :<br>
<br>Réduire la surface d'attaque en minimisant l'exposition des services.
<br>Limiter l'accès non autorisé aux services à travers des interfaces réseau inappropriées.
<br>Améliorer la posture de sécurité globale en renforçant le cloisonnement des services réseau.
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a> 
<br>principe associé: <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>lynis - petit impact sur la notation Lynis (+1)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br><br>
<br>Listez tous les services actifs et les interfaces sur lesquelles ils écoutent:
<br>sudo ss -tuln
<br>
<br>Examinez les services écoutant sur des interfaces non souhaitées (ex. 0.0.0.0 ou :: qui exposent le service à toutes les interfaces réseau).
<br><br>
<br>Modifiez les configurations pour restreindre chaque service à une interface spécifique.
<br>Exemple avec SSH<br>
Modifiez le fichier /etc/ssh/sshd_config :
<br>ListenAddress 127.0.0.1
ListenAddress &lt;adresse_IP_spécifique&gt;
<br>Rechargez le service SSH:<br>sudo systemctl reload sshd
<br><br>Confirmez que les services n’écoutent plus que sur les interfaces configurées :<br>ss -utl
<br><br>Désactivez ou arrêtez les services inutilisés pour réduire encore la surface d'attaque :<br>sudo systemctl disable &lt;service&gt;
sudo systemctl stop &lt;service&gt;
<br><br>Utilisez ufw ou iptables pour contrôler davantage l'accès aux services réseau :<br>
Exemple avec ufw :<br>sudo apt install ufw
sudo ufw allow from 192.168.1.0/24 to any port 22
sudo ufw deny from any to any port 22
sudo ufw enable
<br><br>Utilisez des outils comme Lynis pour auditer régulièrement la configuration réseau :<br>sudo lynis audit system
<br><br>Effectuez des scans de ports régulièrement pour vous assurer qu’aucun service non désiré n’est exposé :<br>sudo nmap -sS localhost
<br><br>Cette mesure réduit considérablement la surface d'attaque en s’assurant que les services réseau n’écoutent que sur les interfaces nécessaires. Elle repose sur une configuration minutieuse et une supervision continue pour éviter tout retour à des paramètres non sécurisés. L’utilisation combinée de ss, ufw et des audits réguliers avec Lynis ou d’autres outils garantit une gestion efficace des services réseau.]]></description><link>wiki\configuration-des-services\r80-réduire-la-surface-d&apos;attaque-des-services-réseau.html</link><guid isPermaLink="false">Wiki/Configuration des services/R80 - Réduire la surface d&apos;attaque des services réseau.md</guid><pubDate>Sun, 15 Dec 2024 21:10:54 GMT</pubDate></item><item><title><![CDATA[Sommaire - Configuration des services]]></title><description><![CDATA[ 
 <br><br>
<br><a data-href="R62 - Désactiver les services non nécessaires" href="wiki\configuration-des-services\r62-désactiver-les-services-non-nécessaires.html" class="internal-link" target="_self" rel="noopener nofollow">R62 - Désactiver les services non nécessaires</a>
<br><a data-href="R63 - Désactiver les fonctionnalités des services non essentielles" href="wiki\configuration-des-services\r63-désactiver-les-fonctionnalités-des-services-non-essentielles.html" class="internal-link" target="_self" rel="noopener nofollow">R63 - Désactiver les fonctionnalités des services non essentielles</a>
<br><a data-href="R67 - Sécurisé les authentifications par PAM" href="wiki\configuration-des-services\r67-sécurisé-les-authentifications-par-pam.html" class="internal-link" target="_self" rel="noopener nofollow">R67 - Sécurisé les authentifications par PAM</a>
<br><a data-href="R68 - Protéger les mots de passe stockés" href="wiki\configuration-des-services\r68-protéger-les-mots-de-passe-stockés.html" class="internal-link" target="_self" rel="noopener nofollow">R68 - Protéger les mots de passe stockés</a>
<br><a data-href="R70 - Séparer les comptes systèmes et d'administrateur de l'annuaire" href="wiki\configuration-des-services\r70-séparer-les-comptes-systèmes-et-d'administrateur-de-l'annuaire.html" class="internal-link" target="_self" rel="noopener nofollow">R70 - Séparer les comptes systèmes et d'administrateur de l'annuaire</a>
<br><a data-href="R74 - Durcir le service de messagerie locale" href="wiki\configuration-des-services\r74-durcir-le-service-de-messagerie-locale.html" class="internal-link" target="_self" rel="noopener nofollow">R74 - Durcir le service de messagerie locale</a>
<br><a data-href="R75 - Configurarer un Alias de messagerie des comptes de service" href="wiki\configuration-des-services\r75-configurarer-un-alias-de-messagerie-des-comptes-de-service.html" class="internal-link" target="_self" rel="noopener nofollow">R75 - Configurarer un Alias de messagerie des comptes de service</a>
<br><a data-href="R79 - Durcir et surveiller les services exposés" href="wiki\configuration-des-services\r79-durcir-et-surveiller-les-services-exposés.html" class="internal-link" target="_self" rel="noopener nofollow">R79 - Durcir et surveiller les services exposés</a>
<br><a data-href="R80 - Réduire la surface d'attaque des services réseau" href="wiki\configuration-des-services\r80-réduire-la-surface-d'attaque-des-services-réseau.html" class="internal-link" target="_self" rel="noopener nofollow">R80 - Réduire la surface d'attaque des services réseau</a>
<br>]]></description><link>wiki\configuration-des-services\sommaire-configuration-des-services.html</link><guid isPermaLink="false">Wiki/Configuration des services/Sommaire - Configuration des services.md</guid><pubDate>Sun, 15 Dec 2024 22:32:37 GMT</pubDate></item><item><title><![CDATA[R1 - Choisir et configurer son matériel]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIR" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIR</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> 
 <br><br>L'objectif principal de la recommandation R1 de l'ANSSI est de garantir que le matériel utilisé pour les postes clients et serveurs soit conforme aux exigences de sécurité définies, afin de limiter les risques liés à des vulnérabilités matérielles ou des configurations inadéquates. Cela permet de :<br>
<br>Sélectionner un matériel compatible avec les bonnes pratiques de sécurité.
<br>Réduire les risques liés à des failles matérielles ou des fonctionnalités non maîtrisées.
<br>Assurer une base solide pour l’installation et la sécurisation des systèmes.
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MIR" class="tag" target="_blank" rel="noopener nofollow">#MIR</a>
<br>principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>lynis - pas d'incident sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-configuration-materielle-de-postes-clients-et-serveurs-x86" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-configuration-materielle-de-postes-clients-et-serveurs-x86" target="_blank">Recommandations de configuration matérielle de postes clients et serveurs x86 - ANSSI</a><br><br><br>
<br>Référez-vous à la note technique dédiée pour les recommandations matérielles. Elle fournit des exigences spécifiques concernant :

<br>Les processeurs (par exemple, support de technologies de virtualisation et de chiffrement).
<br>Les fonctionnalités de démarrage sécurisé (UEFI Secure Boot).
<br>La compatibilité avec des solutions de gestion des mises à jour et des correctifs.


<br><br>
<br>Assurez-vous que le matériel sélectionné inclut :

<br>Un support pour le démarrage sécurisé (UEFI avec Secure Boot activé).
<br>Des fonctionnalités de chiffrement matériel (par exemple, AES-NI pour les processeurs Intel).
<br>Une gestion correcte des mises à jour microcode du processeur.
<br>Une compatibilité avec les modules matériels de sécurité (par exemple, TPM 2.0 pour la gestion des clés).


<br><br>
<br>
Accédez au BIOS/UEFI et activez les fonctionnalités sécuritaires :

<br>Activez Secure Boot pour empêcher le chargement de logiciels malveillants au démarrage.
<br>Désactivez les fonctionnalités inutiles telles que les ports USB, FireWire, ou Thunderbolt si non nécessaires.
<br>Activez le support du chiffrement matériel et de la virtualisation (VT-x, VT-d).


<br>
Exemple de configuration UEFI :

<br>Redémarrez la machine et accédez au menu UEFI/BIOS (souvent en appuyant sur Del, F2, ou Esc).
<br>Naviguez jusqu'aux paramètres de sécurité et activez Secure Boot.


<br><br>
<br>Mettez à jour le microcode du processeur pour corriger les failles matérielles :
<br>sudo apt install intel-microcode   # Pour les processeurs Intel
sudo apt install amd64-microcode  # Pour les processeurs AMD
sudo reboot
<br><br>
<br>Si le matériel est utilisé pour la virtualisation, configurez le support IOMMU (Intel VT-d/AMD-Vi) dans le BIOS/UEFI. Cela améliore l’isolation des machines virtuelles.
<br><br>Exécutez un outil comme dmidecode ou lscpu pour confirmer que les fonctionnalités activées sont prises en charge :<br>sudo dmidecode -t system
sudo lscpu
<br><br>
<br>Configurez un processus de mise à jour régulière du firmware et du BIOS pour corriger les vulnérabilités.
<br>Exécutez un outil comme fwupd pour automatiser les mises à jour du firmware :
<br>sudo apt install fwupd
sudo fwupdmgr refresh
sudo fwupdmgr get-updates
sudo fwupdmgr update
<br><br>La sélection et la configuration correcte du matériel sont essentielles pour établir une base solide de sécurité. L’application stricte des recommandations de l’ANSSI garantit que le matériel ne devient pas un point faible dans la chaîne de sécurité. Cette procédure doit être complétée par une vérification continue des mises à jour matérielles et du firmware.]]></description><link>wiki\configuration-matérielle\r1-choisir-et-configurer-son-matériel.html</link><guid isPermaLink="false">Wiki/Configuration matérielle/R1 - Choisir et configurer son matériel.md</guid><pubDate>Sun, 15 Dec 2024 23:01:33 GMT</pubDate></item><item><title><![CDATA[R2 - Configurer le BIOS_UEFI]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> 
 <br><br>L'objectif principal de la recommandation R2 est de configurer correctement le BIOS/UEFI afin de renforcer la sécurité du matériel et des systèmes d'exploitation qui y sont déployés. Une configuration robuste permet de :<br>
<br>Prévenir l’exécution de logiciels non autorisés au démarrage grâce au Secure Boot.
<br>Réduire la surface d’attaque en désactivant les fonctionnalités non utilisées.
<br>Renforcer l’isolation matérielle pour protéger les ressources critiques.
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>principe associé - <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-configuration-materielle-de-postes-clients-et-serveurs-x86" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-configuration-materielle-de-postes-clients-et-serveurs-x86" target="_blank">Recommandations de configuration matérielle de postes clients et serveurs x86 - ANSSI</a><br><br><br>
<br>Redémarrez la machine et accédez au menu BIOS/UEFI en appuyant sur une touche spécifique (par exemple Del, F2, ou Esc) pendant le démarrage.
<br><br>
<br>Dans les paramètres de sécurité ou de démarrage, localisez l’option Secure Boot.
<br>Activez-la pour empêcher le chargement de logiciels non signés au démarrage.
<br><br>
<br>Réglez l’ordre de démarrage pour ne permettre que le démarrage depuis les périphériques nécessaires (ex. : disque dur principal, réseau pour PXE si requis).
<br>Désactivez le démarrage depuis des supports amovibles (USB, CD/DVD) si non nécessaire.
<br><br>
<br>
Désactivez les composants matériels non utilisés pour limiter la surface d’attaque :

<br>Ports USB, FireWire, ou Thunderbolt (si inutilisés).
<br>Contrôleurs réseau secondaires.
<br>Fonctions spécifiques comme Wake-on-LAN ou gestion à distance (sauf si elles sont strictement nécessaires).


<br><br>
<br>Si le système ou l’utilisation prévoit des environnements virtualisés, activez les options de virtualisation matérielle (Intel VT-x, VT-d ou AMD-V).
<br>Cela permet une isolation renforcée des ressources des machines virtuelles.
<br><br>
<br>Si un TPM (version 2.0 de préférence) est disponible, activez-le pour assurer la gestion des clés de chiffrement et l’intégrité du système.
<br><br>
<br>Configurez un mot de passe administrateur dans le BIOS/UEFI pour protéger les paramètres contre les modifications non autorisées.
<br><br>
<br>Assurez-vous que la version du BIOS/UEFI est à jour pour corriger les éventuelles vulnérabilités.
<br>Consultez le site du fabricant pour obtenir le dernier firmware.<br>
exemple avec fwupd:
<br>sudo apt install fwupd
sudo fwupdmgr refresh
sudo fwupdmgr get-updates
sudo fwupdmgr update
<br><br>
<br>Redémarrez et testez la configuration pour s'assurer qu'aucune option indésirable n’est active.
<br>Confirmez que le démarrage sécurisé est fonctionnel en vérifiant que seuls des systèmes signés sont chargés.
<br><br>La configuration du BIOS/UEFI est une étape essentielle pour renforcer la sécurité matérielle dès le démarrage. Elle doit être réalisée avec précaution pour éviter tout blocage involontaire du système. Les mises à jour régulières et la surveillance des paramètres garantissent une protection durable contre les attaques exploitant les faiblesses matérielles.]]></description><link>wiki\configuration-matérielle\r2-configurer-le-bios_uefi.html</link><guid isPermaLink="false">Wiki/Configuration matérielle/R2 - Configurer le BIOS_UEFI.md</guid><pubDate>Sun, 15 Dec 2024 23:01:48 GMT</pubDate></item><item><title><![CDATA[R3 - Activer le démarrage sécurisé UEFI]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> 
 <br><br>L'objectif de la recommandation R3 est de garantir l'intégrité du processus de démarrage en activant le démarrage sécurisé (Secure Boot) dans l'environnement UEFI. Cela permet de :<br>
<br>Empêcher l'exécution de logiciels non autorisés ou malveillants au démarrage.
<br>Vérifier que seuls les composants signés par des autorités de confiance démarrent le système.
<br>Réduire les risques de compromission de la chaîne de démarrage (bootloader, noyau).
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 
<br>principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>lynis - petit impact sur le score (+1)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br><br>
<br>Assurez-vous que votre distribution Linux est compatible avec UEFI Secure Boot. La plupart des distributions modernes, telles que Debian, Ubuntu, Fedora, ou CentOS, prennent en charge Secure Boot.
<br>Pour Debian, installez les paquets nécessaires si ce n'est pas déjà fait :<br>sudo apt install shim-signed grub-efi-amd64-signed
<br><br>Redémarrez la machine et entrez dans le menu BIOS/UEFI en appuyant sur une touche spécifique (par exemple, Del, F2, ou Esc) pendant le démarrage.<br><br>
<br>Localisez l’option Secure Boot dans les paramètres UEFI.
<br>Activez-le et enregistrez les modifications.
<br><br>
<br>Si votre BIOS/UEFI le permet, configurez Secure Boot pour utiliser les clés de confiance par défaut de votre système ou ajoutez des clés personnalisées.
<br>Mode d'installation par défaut : Utilisez les clés fournies par le fabricant ou par la distribution Linux.<br>
Exemple d’ajout de clés avec mokutil :<br>
Si des modules ou des noyaux personnalisés sont utilisés, ajoutez-les aux clés approuvées :
<br>sudo apt install mokutil
sudo mokutil --import /chemin/vers/certificat.der
<br><br>Confirmez que GRUB est configuré pour fonctionner avec Secure Boot. Sur Debian, cela est souvent automatique si vous avez installé les paquets signés :<br>sudo apt install grub-efi-amd64-signed
sudo update-grub
<br><br>
<br>Redémarrez votre machine pour tester la configuration.
<br>Assurez-vous que le système démarre correctement avec Secure Boot activé.
<br>Pour vérifier que Secure Boot est actif sous Linux :<br>sudo dmesg | grep -i secure
<br><br>
<br>Si le système refuse de démarrer, désactivez temporairement Secure Boot pour corriger les éventuelles incompatibilités (par exemple, des modules non signés).
<br><br>Utilisez des outils comme Lynis pour effectuer des audits périodiques sur la sécurité du démarrage :<br>sudo lynis audit system
<br><br>Activer Secure Boot renforce considérablement la sécurité dès le démarrage, en vérifiant l'intégrité des composants critiques. Cependant, son efficacité dépend de la configuration appropriée des clés et des modules utilisés par le système. Il est essentiel de tester le processus après l'activation pour identifier et résoudre tout problème de compatibilité.]]></description><link>wiki\configuration-matérielle\r3-activer-le-démarrage-sécurisé-uefi.html</link><guid isPermaLink="false">Wiki/Configuration matérielle/R3 - Activer le démarrage sécurisé UEFI.md</guid><pubDate>Sun, 15 Dec 2024 21:03:27 GMT</pubDate></item><item><title><![CDATA[R4 - Remplacer les clés préchargées]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> 
 <br><br>L’objectif de la recommandation R4 est de renforcer la sécurité de la chaîne de démarrage en remplaçant les clés préchargées par défaut dans l’UEFI par des clés personnalisées. Cela permet de :<br>
<br>Éviter les risques liés à des clés par défaut potentiellement compromises.
<br>Garantir que seuls les composants signés par une autorité de confiance interne sont autorisés à démarrer.
<br>Prévenir l'exécution de chargeurs de démarrage ou noyaux non approuvés, même en cas d’attaque externe.
<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a> 
<br>principe associé - <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a>
<br>lynis - pas d'impact sur la notation (+0)
<br><br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Recommandations de sécurité relatives à un système GNU/Linux - ANSSI</a><br><br><br>
<br>Générer de nouvelles clés privées et publiques pour signer le chargeur de démarrage et le noyau :
<br>openssl req -new -x509 -newkey rsa:2048 -keyout private_key.key -out public_key.crt -days 3650 -nodes -subj "/CN=Custom Secure Boot Key"
<br>
<br>Convertir les clés dans un format compatible avec UEFI (DER) :
<br>openssl x509 -outform DER -in public_key.crt -out public_key.der
<br><br>
<br>Installer l’outil mokutil (si non déjà installé) pour gérer les clés du système :
<br>sudo apt install mokutil
<br>Ajouter les clés à la Machine Owner Key (MOK) :<br>sudo mokutil --import public_key.der
<br>
<br>
Suivez les instructions à l'écran pour définir un mot de passe de confirmation et redémarrez le système.

<br>
Lors du redémarrage, utilisez l’interface de gestion de clés (MOK Manager) pour valider l'importation des clés.

<br><br>
<br>Accéder au BIOS/UEFI en redémarrant la machine et en appuyant sur la touche spécifique (par exemple, Del, F2, ou Esc).
<br>Dans la section Secure Boot, passez en mode de gestion manuelle des clés (Custom Mode).
<br>Supprimez les clés préchargées par défaut (PK, KEK, DB).
<br>Importez les nouvelles clés générées (PK, KEK et DB).
<br>Détails des clés :<br>
<br>PK (Platform Key) : Sert à valider les KEK.
<br>KEK (Key Exchange Key) : Gère les signatures des bases de données de démarrage.
<br>DB (Database) : Contient les signatures approuvées pour le chargeur de démarrage et le noyau.
<br><br>
<br>Signer le chargeur de démarrage (exemple avec GRUB) :
<br>sbsign --key private_key.key --cert public_key.crt /boot/efi/EFI/debian/grubx64.efi --output /boot/efi/EFI/debian/grubx64.efi
<br>
<br>Signer le noyau Linux au format EFI :
<br>sbsign --key private_key.key --cert public_key.crt /boot/vmlinuz --output /boot/vmlinuz.signed
<br><br>
<br>Mettez à jour GRUB pour utiliser le noyau signé :
<br>sudo nano /etc/default/grub
# Ajouter la ligne suivante pour spécifier le noyau signé
GRUB_DEFAULT="/boot/vmlinuz.signed"
sudo update-grub
<br><br>
<br>Confirmer que les nouvelles clés et signatures sont utilisées lors du démarrage :
<br>sudo dmesg | grep -i secure
<br><br>
<br>Documentez les clés générées et configurez un processus pour leur rotation sécurisée.
<br>Effectuez régulièrement des audits pour vérifier que seules les clés approuvées sont en place.
<br><br>Le remplacement des clés préchargées dans l’UEFI constitue une étape avancée de sécurisation qui donne à l’administrateur un contrôle total sur la chaîne de démarrage. Cependant, cela peut entraîner des incompatibilités avec certains composants ou périphériques non signés, nécessitant une préparation minutieuse. Cette procédure est particulièrement pertinente pour des environnements critiques ou sensibles.]]></description><link>wiki\configuration-matérielle\r4-remplacer-les-clés-préchargées.html</link><guid isPermaLink="false">Wiki/Configuration matérielle/R4 - Remplacer les clés préchargées.md</guid><pubDate>Sun, 15 Dec 2024 21:03:37 GMT</pubDate></item><item><title><![CDATA[Sommaire - Configuration matérielle]]></title><description><![CDATA[ 
 <br><br>
<br><a data-href="R1 - Choisir et configurer son matériel" href="wiki\configuration-matérielle\r1-choisir-et-configurer-son-matériel.html" class="internal-link" target="_self" rel="noopener nofollow">R1 - Choisir et configurer son matériel</a>
<br><a data-href="R2 - Configurer le BIOS_UEFI" href="wiki\configuration-matérielle\r2-configurer-le-bios_uefi.html" class="internal-link" target="_self" rel="noopener nofollow">R2 - Configurer le BIOS_UEFI</a>
<br><a data-href="R3 - Activer le démarrage sécurisé UEFI" href="wiki\configuration-matérielle\r3-activer-le-démarrage-sécurisé-uefi.html" class="internal-link" target="_self" rel="noopener nofollow">R3 - Activer le démarrage sécurisé UEFI</a>
<br><a data-href="R4 - Remplacer les clés préchargées" href="wiki\configuration-matérielle\r4-remplacer-les-clés-préchargées.html" class="internal-link" target="_self" rel="noopener nofollow">R4 - Remplacer les clés préchargées</a>
<br>]]></description><link>wiki\configuration-matérielle\sommaire-configuration-matérielle.html</link><guid isPermaLink="false">Wiki/Configuration matérielle/Sommaire - Configuration matérielle.md</guid><pubDate>Sun, 15 Dec 2024 22:32:43 GMT</pubDate></item><item><title><![CDATA[R5 - Configuration d'un mot de passe pour le chargeur de démarrage]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Chargeur_de_démarrage" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Chargeur_de_démarrage</a> 
 <br><br>L'objectif de cette procédure est de sécuriser l'accès au chargeur de démarrage d'un système en y configurant un mot de passe. Cela permettra de limiter l'accès non autorisé aux paramètres critiques du système, comme les options de démarrage ou les périphériques bootables.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags:  <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Chargeur_de_démarrage" class="tag" target="_blank" rel="noopener nofollow">#Chargeur_de_démarrage</a> 
<br>Lynis - Ajout de cette mesure: Aucun impact notable sur le score - 63
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br>Documentation officielle du chargeur de démarrage utilisé (ex : Documentation GRUB)
<br>Tutoriel en ligne <a data-tooltip-position="top" aria-label="https://linuxconfig.org/how-to-secure-grub-boot-loader-with-password" rel="noopener nofollow" class="external-link" href="https://linuxconfig.org/how-to-secure-grub-boot-loader-with-password" target="_blank">linuxconfig</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide de durcissement</a>
<br><br><br>**1. Générer un hash de mot de passe:<br>
<br>Utiliser la commande suivante:
<br>grub-mkpasswd-pbkdf2
<br>
<br>Entrer le mot de passe souhaité
<br>Copier le hash retourné. La syntaxe devrait être la suivante:
<br>grub.pbkdf2.sha512.10000.E445BF6972448C3C9A80FEA955261DC3F018B5E4D8B23D429D425237AC5FEE97FA80690E9047011367DF6A7434B9734E60DBFC8CE331AF8BBE58A53AEF335BC5.4E78D0F7E32160263B571F3B4D8ECB80B4BB0A737272EE302C9B7F53AD5295DDDEF9F06A21AA9F466DDD3F7D5A0E9A628E72302D293B72C5B3D328E069594914
<br><br>**2. Définir le mot de passe précédemment établi pour le chargeur de démarrage<br>
<br>Ouvrir le fichier du chargeur de démarrage:
<br>nano /etc/grub.d/40_custom
<br>
<br>Ajouter les lignes suivantes à la fin du fichier:
<br>set superusers="votre_utilisateur"
password_pbkdf2 votre_utilisateur hash_généré_précédemment
<br>
<br>Mettre à jour la configuration du chargeur de démarrage GRUB:
<br>update-grub
<br><br><br> Avantages :<br>
<br>Simplicité et efficacité : Cette mesure est extrêmemnt simple et rapide à mettre en place, pourtant, elle renforce la sécurité de la machine de manière considérable.
<br>Protéger l'accès au mode "Mono-utilisateur" : Si un attaquant accède au mode "Mono-utilisateur" (ou "Single user mode en anglais"), il serait en mesure de réinitialiser les mots de passes et identifiants du système.
<br>Limites :<br>
<br>La mise en place de ce type de mesure est surtout intéressant pour prévenir les attaques physiques (intrusion frauduleuse dans un bâtiment, vol de poste informatique etc.)
<br>Le mot de passe est par défnition demandé seulement à l'apparition du chargeur de démarrage et donc à son allumage.
<br>En raison des deux premiers points, il serait une très mauvaise idée d'activer ce type de mesure sur une machine dont une activité distante est importante (maintenance à distance, administration à distance etc.) Un simple redémarrage forcerait l'intervention physique de quelqu'un pour entrer le mot de passe avant de pouvoir relancer les services d'accès à distance tels que SSH ou RDP.
<br>Un oubli de mot de passe rend l'accès au système d'exploitation complètement impossible. C'est donc à la fois une très bonne mesure de protection, mais qui peut très vite se retrouver à double tranchant.
]]></description><link>wiki\configuration-noyau\r5-configuration-d&apos;un-mot-de-passe-pour-le-chargeur-de-démarrage.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R5 - Configuration d&apos;un mot de passe pour le chargeur de démarrage.md</guid><pubDate>Sun, 15 Dec 2024 23:16:19 GMT</pubDate></item><item><title><![CDATA[R6 - Protéger les paramètres de ligne de commande du noyau et l'initramfs]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> 
 <br><br>Empêcher la modification des paramètres de lancement du noyau<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a> 

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>   
<br>Tags:  <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a>
<br>Lynis - Ajout de cette mesure: Aucun impact notable sur le score - 63
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://wiki.gentoo.org/wiki/Unified_kernel_image" rel="noopener nofollow" class="external-link" href="https://wiki.gentoo.org/wiki/Unified_kernel_image" target="_blank">Documentation Gentoo</a>
<br><a data-tooltip-position="top" aria-label="https://wiki.archlinux.org/title/Unified_kernel_image" rel="noopener nofollow" class="external-link" href="https://wiki.archlinux.org/title/Unified_kernel_image" target="_blank">Documentation ArchLinux</a>
<br><a data-tooltip-position="top" aria-label="https://github.com/ErnyTech/Unified-Kernel-Image" rel="noopener nofollow" class="external-link" href="https://github.com/ErnyTech/Unified-Kernel-Image" target="_blank">Exemple de script</a>
<br><br><br><br>
<br>Créer un fichier cmdline.txt contenant les paramètres de ligne de commande souhaités:
<br>echo "root=UUID=&lt;UUID&gt; rw" &gt; cmdline.txt
<br>
<br>Utiliser objcopy pour créer notre image:
<br>objcopy \
  --add-section .osrel=/etc/os-release --change-section-vma .osrel=0x20000 \
  --add-section .cmdline=cmdline.txt --change-section-vma .cmdline=0x30000 \
  --add-section .linux=/boot/vmlinuz --change-section-vma .linux=0x40000 \
  --add-section .initrd=/boot/initramfs.img --change-section-vma .initrd=0x3000000 \
  /usr/lib/systemd/boot/efi/linuxx64.efi.stub uki.efi 
<br><br>
<br>Générer une paire de clef pour Secure Boot si elle n'existe pas encore:
<br>openssl req -new -x509 -newkey rsa:2048 -keyout SecuBoot.key -out SecuBoot.crt -nodes -days 365
<br>
<br>Signer l'image avec sbsign:
<br>sbsign --key SecuBoot.key --cert SecuBoot.crt --output ukiSigned.efi uki.efi
<br>
<br>Importer la clé dans UEFI si elle ne l'est pas déjà:
<br>mokutil --import SecuBoot.crt
<br><br>
<br>Copier l’image :
<br>cp ukiSigned.efi /boot/efi/EFI/Linux/
<br>
<br>Ouvrir le fichier suivant:
<br>nano /etc/grub.d/40_custom
<br>
<br>Ajouter les lignes suivantes:
<br>menuentry 'LeNomDeVotreEntrée' {
	insmod fat
	insmod chain
	search --no-floppy --set=root --fs-uuid &lt;FILESYSTEM_UUID&gt;
	chainloader /EFI/Linux/ukiSigned.efi
}
<br><br><br>Le démarrage sécurisé UEFI  permet d’assurer l’intégrité et l’authenticité des binaires UEFI lors du démarrage. Cependant, les paramètres de ligne de commande du noyau et l’initramfs n’étant pas des binaires UEFI, ils ne sont pas protégés par le démarrage sécurisé.<br>
L'objectif de cette maneuvre est donc de créer une Unified kernel image qui regroupe le noyau, l’initramfs et les paramètres de ligne de commande du noyau dans un seul binaire UEFI.<br>
La signature de ce dernier sera ensuite vérifiée au démarrage du système, assurant l’intégrité et l’authenticité de tous ces composants.]]></description><link>wiki\configuration-noyau\r6-protéger-les-paramètres-de-ligne-de-commande-du-noyau-et-l&apos;initramfs.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R6 - Protéger les paramètres de ligne de commande du noyau et l&apos;initramfs.md</guid><pubDate>Sun, 15 Dec 2024 23:16:10 GMT</pubDate></item><item><title><![CDATA[R7 - Activation de l'IOMMU]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIR" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIR</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_de_la_mémoire" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_de_la_mémoire</a> <a class="tag" href="?query=tag:Chargeur_de_démarrage" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Chargeur_de_démarrage</a> 
 <br><br>L'objectif de cette procédure est d'activer la fonction IOMMU (Input-Output Memory Management Unit) sur un système. L'IOMMU permet une gestion avancée des entrées/sorties en attribuant des plages de mémoire dédiées aux périphériques d'I/O, ce qui est essentiel pour la virtualisation et pour l'amélioration de la sécurité (prévention des attaques de type Direct Memory Access ou DMA).<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIR" class="tag" target="_blank" rel="noopener nofollow">#MIR</a>

<br>Recommandation de niveau renforcé. A mettre en œuvre sur des systèmes ayant un fort besoin de sécurité ou ayant plusieurs applications à isoler les unes des autres sur le même système.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags:  <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_de_la_mémoire" class="tag" target="_blank" rel="noopener nofollow">#Configuration_de_la_mémoire</a> <a href=".?query=tag:Chargeur_de_démarrage" class="tag" target="_blank" rel="noopener nofollow">#Chargeur_de_démarrage</a> 
<br>Lynis - Ajout de cette mesure: Aucun impact notable sur le score - 63
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://www.sstic.org/media/SSTIC2010/SSTIC-actes/Analyse_de_l_efficacite_du_service_fourni_par_une_/SSTIC2010-Article-Analyse_de_l_efficacite_du_service_fourni_par_une_IOMMU-lacombe_lone-sang_nicomette_deswarte.pdf" rel="noopener nofollow" class="external-link" href="https://www.sstic.org/media/SSTIC2010/SSTIC-actes/Analyse_de_l_efficacite_du_service_fourni_par_une_/SSTIC2010-Article-Analyse_de_l_efficacite_du_service_fourni_par_une_IOMMU-lacombe_lone-sang_nicomette_deswarte.pdf" target="_blank">Etude menée sur l'impact de l'IOMMU</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide de durcissement</a>
<br><br><br>
<br>Ouvrir le fichier de configuration du chargeur de démarrage:
<br>nano /etc/default/grub
<br>
<br>Modifier les options de la ligne GRUB_CMDLINE_LINUX comme suit:
<br>GRUB_CMDLINE_LINUX= "iommu=force"
<br>
Si la ligne contient d'autres options, ne pas les supprimer, simplement rajouter un espace et iommu=force à la liste
<br>
<br>Appliquer les mises à jour:
<br>update-grub
<br><br><br> Avantages :<br>
<br>Cette mesure est extrêmement simple et rapide à mettre en place.
<br>Permet de protéger la mémoire système en isolant les périphériques. Cela empêche un périphérique compromis (ou malveillant) d'accéder à des zones critiques de la mémoire.
<br>Elle peut également éviter des conflits d’accès mémoire causés par des pilotes ou des périphériques mal configurés.
<br>Limites :<br>
<br>L'activation de l'IOMMU peut introduire une légère surcharge en raison de la gestion des traductions mémoire entre les périphériques et la mémoire principale.
<br>L’activation de l’IOMMU sur un système peut engendrer des instabilités matérielles, il convient donc de s’assurer du bon fonctionnement de celui-ci avant de déployer une telle mesure en production.
]]></description><link>wiki\configuration-noyau\r7-activation-de-l&apos;iommu.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R7 - Activation de l&apos;IOMMU.md</guid><pubDate>Sun, 15 Dec 2024 22:54:57 GMT</pubDate></item><item><title><![CDATA[R8 - Paramétrer les options de configuration de la mémoire]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_de_la_mémoire" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_de_la_mémoire</a> <a class="tag" href="?query=tag:Chargeur_de_démarrage" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Chargeur_de_démarrage</a> 
 <br><br>Cette mesure est différente des autres dans le sens où elle vient définir une liste d'option activable pour configurer la mémoire<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags: <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_de_la_mémoire" class="tag" target="_blank" rel="noopener nofollow">#Configuration_de_la_mémoire</a> <a href=".?query=tag:Chargeur_de_démarrage" class="tag" target="_blank" rel="noopener nofollow">#Chargeur_de_démarrage</a>
<br>Lynis - Ajout de cette mesure: Aucun impact notable sur le score - 63
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://wonderfall.space/linux-bricoles/" rel="noopener nofollow" class="external-link" href="https://wonderfall.space/linux-bricoles/" target="_blank">Tutoriel durcissement</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br>
<br>Ouvrir le fichier de configuration du chargeur de démarrage:
<br>nano /etc/default/grub
<br>
<br>Modifier les options de la ligne GRUB_CMDLINE_LINUX comme suit:
<br>GRUB_CMDLINE_LINUX= "page_poison=on pti=on slab_nomerge=yes slub_debug=FZP spec_store_bypass_disable=seccomp spectre_v2=on mds=full mce=0 page_alloc.shuffle=1 rng_core.default_quality=500"
<br>
Si la ligne contient d'autres options, ne pas les supprimer, simplement rajouter un espace et cette option à la liste
<br>
<br>Appliquer les mises à jour:
<br>update-grub
<br>
En fonction du système, nous recommandons d'ajouter à la liste:<br>
- l1tf=full: dans le cas ou la machine est déstinée à servir d'hyperviseur pour activer les contre-mesures envers L1 Terminal Fault<br>
- l1tf=off: dans le cas contraire, puisque l'activation de cette option est irréversible et pourrait avoir de sérieux impacts sur les performances du système.
<br><br><br>Il est fortement conseillé d'aller se renseigner sur le guide de l'ANSSI pour connaître plus en détail l'utilité de chacunes des options. En effet, certaines de ces options peuvent être plus ou moins utiles en fonction des cas d'utilisation du système, et certaines pourraient impacter les performances. Cependant, il est important de noter que cette liste permet d'activer une importante liste de contre-mesures, et élève donc sérieusement la sécurité du système.]]></description><link>wiki\configuration-noyau\r8-paramétrer-les-options-de-configuration-de-la-mémoire.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R8 - Paramétrer les options de configuration de la mémoire.md</guid><pubDate>Sun, 15 Dec 2024 22:56:46 GMT</pubDate></item><item><title><![CDATA[R9 - Paramétrer les options de configuration du noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_du_noyau" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_du_noyau</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>Cette mesure est différente des autres dans le sens où elle vient définir une liste d'option activable pour configurer le noyau<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>  
<br>Tags: <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_du_noyau" class="tag" target="_blank" rel="noopener nofollow">#Configuration_du_noyau</a> <a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a>
<br>Lynis - Ajout de cette mesure: Amélioration du score de un point - 64
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://linux-audit.com/linux-hardening-with-sysctl/" rel="noopener nofollow" class="external-link" href="https://linux-audit.com/linux-hardening-with-sysctl/" target="_blank">Comment modifier les paramètres sysctl</a>
<br><a data-tooltip-position="top" aria-label="https://wonderfall.space/linux-bricoles/" rel="noopener nofollow" class="external-link" href="https://wonderfall.space/linux-bricoles/" target="_blank">Tutoriel durcissement</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système:
<br>nano /etc/sysctl.conf
<br>
<br>Ajouter les lignes suivantes:
<br>kernel.dmesg_restrict=1 
kernel.kptr_restrict=2 
kernel.pid_max=65536 
kernel.perf_cpu_time_max_percent=1 
kernel.perf_event_max_sample_rate=1 
kernel.perf_event_paranoid=2 
kernel.randomize_va_space=2 
kernel.sysrq=0 
kernel.unprivileged_bpf_disabled=1 
kernel.panic_on_oops=1
<br>
Commentaire de l'ANSSI sur chacune des lignes

<br>kernel.dmesg_restrict=1: Restreint l'accès au buffer dmesg
<br>kernel.kptr_restrict=2: Cache les adresses noyau dans /proc et les différentes autres interfaces y compris aux utilisateurs privilégiés 
<br>kernel.pid_max=65536: Spécifie explicitement l'espace d'identifiants de processus supporté par le noyau , 65 536 étant une valeur donnée à titre d'exemple
<br>kernel.perf_cpu_time_max_percent=1et kernel.perf_event_max_sample_rate=1: Restreignent l'utilisation du sous-système perf
<br>kernel.perf_event_paranoid=2: Interdit l'accès non privilégié à l'appel système perf_event_open(). Avec une valeur plus grande que 2, on impose la possession de CAP_SYS_ADMIN, pour pouvoir recueillir les évènements perf. 
<br>kernel.randomize_va_space=2: Active l'ASLR 
<br>kernel.sysrq=0: Désactive les combinaisons de touches magiques
<br>kernel.unprivileged_bpf_disabled=1: Restreint l'usage du BPF noyau aux utilisateurs privilégiés
<br>kernel.panic_on_oops=1: Arrête complètement le système en cas de comportement inattendu du noyau Linux 

<br>
<br>Appliquer les mises à jour:
<br>sysctl --system
<br><br><br>Ces paramètres de configuration du noyau sont assez génériques mais permettent de renforcer la sécurité en limitant des fonctionnalités que l'on pourrait considérer comme risquées et en contrôlant plus précisemment l'accès à certaines informations sensibles du système.]]></description><link>wiki\configuration-noyau\r9-paramétrer-les-options-de-configuration-du-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R9 - Paramétrer les options de configuration du noyau.md</guid><pubDate>Sun, 15 Dec 2024 22:57:46 GMT</pubDate></item><item><title><![CDATA[R10 - Désactiver le chargement des modules noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIR" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIR</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_du_noyau" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_du_noyau</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>La désactivation des chargements de modules permet d'empêcher un attaquant d'importer un module vérolé dans notre système et d'ainsi le contaminer.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIR" class="tag" target="_blank" rel="noopener nofollow">#MIR</a> 

<br>Recommandation de niveau renforcé. A mettre en œuvre sur des systèmes ayant un fort besoin de sécurité ou ayant plusieurs applications à isoler les unes des autres sur le même système.


<br>Principe associé: <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>Tags : <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_du_noyau" class="tag" target="_blank" rel="noopener nofollow">#Configuration_du_noyau</a> <a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a> 
<br>Lynis - Ajout de cette mesure: Aucun impact notable sur le score - 64
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/guide-cloisonnement-systeme" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/guide-cloisonnement-systeme" target="_blank">Guide ANSSI</a>
<br>Comment modifier les paramètres sysctl: <a data-tooltip-position="top" aria-label="https://linux-audit.com/kernel/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading/" rel="noopener nofollow" class="external-link" href="https://linux-audit.com/kernel/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading/" target="_blank">Linux Audit</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système:
<br>nano /etc/sysctl.conf
<br>
<br>Ajouter les lignes suivantes:
<br>kernel.modules_disabled=1
<br>
<br>Appliquer les mises à jour:
<br>sysctl --system
<br><br><br> Avantages :<br>
<br>La mesure est simple à mettre en place
<br>Seul les modules explicitement approuvés pourront être chargés
<br>Prévient des installations de modules vérolés tels que les rootkits.
<br>Limites :<br>
<br>L'activation de cette mesure rend sa désactivation impossible sans un redémarrage
<br>L'activation de cette mesure peut causer des problèmes notamment avec les périphériques USB externes, et serait donc à privilégier sur un système ayant pour vocation à servir de serveur, par exemple.
]]></description><link>wiki\configuration-noyau\r10-désactiver-le-chargement-des-modules-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R10 - Désactiver le chargement des modules noyau.md</guid><pubDate>Sun, 15 Dec 2024 22:57:57 GMT</pubDate></item><item><title><![CDATA[R11 - Activer et configurer le LSM YAMA]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_des_processus" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_processus</a> <a class="tag" href="?query=tag:Chargeur_de_démarrage" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Chargeur_de_démarrage</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>L'objectif de cette procédure est d'activer et de configurer YAMA (Yet Another Mandatory Access control), une fonctionnalité de sécurité du noyau Linux destinée à renforcer les mécanismes de gestion des permissions des processus. YAMA ajoute des restrictions supplémentaires au mécanisme ptrace, qui permet à un processus de contrôler ou de surveiller l'exécution d’un autre processus. Cette configuration est essentielle pour empêcher certaines formes d'attaques, telles que les tentatives d'élévation de privilèges via la manipulation de processus non sécurisés.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>  
<br>Tags : <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_des_processus" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_processus</a>  <a href=".?query=tag:Chargeur_de_démarrage" class="tag" target="_blank" rel="noopener nofollow">#Chargeur_de_démarrage</a>  <a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a> 
<br>Lynis - Ajout de cette mesure: Amélioration du score de un point - 65
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/guide-cloisonnement-systeme" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/guide-cloisonnement-systeme" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://linux-audit.com/linux-hardening-with-sysctl/" rel="noopener nofollow" class="external-link" href="https://linux-audit.com/linux-hardening-with-sysctl/" target="_blank">Comment modifier les paramètres sysctl</a>
<br><a data-tooltip-position="top" aria-label="https://wonderfall.space/linux-bricoles/" rel="noopener nofollow" class="external-link" href="https://wonderfall.space/linux-bricoles/" target="_blank">Tutoriel durcissement</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br><br>
<br>Ouvrir le fichier de configuration du GRUB
<br>nano /etc/default/grub
<br>
<br>Trouver la ligne comportant GRUB_CMDLINE_LINUX_DEFAULT= et la modifier:
<br>GRUB_CMDLINE_LINUX="security=yama"
<br>
Si la ligne contient d'autres options, ne pas les supprimer, simplement rajouter un espace et cette option à la liste
<br>
<br>Mettre à jour la configuration:
<br>update-grub
<br><br>
<br>Ouvrir le fichier de configuration système:
<br>nano /etc/sysctl.conf
<br>
<br>Ajouter la ligne suivante:
<br>kernel.yama.ptrace_scope = 1
<br>
<br>Appliquer les mises à jour:
<br>sysctl --system
<br><br>La configuration de yama peut accepter plusieurs valeurs:<br>
<br>0: tous les processus peuvent être débogués pourvu qu’ils partagent le même UID (User IDentifier ou identifiant utilisateur) 
<br>1: un processus non privilégié (ne possédant pas CAP_SYS_PTRACE) ne peut déboguer que les processus descendants, sauf si le processus cible l’a explicitement autorisé avec la commande prctl(PR_SET_PTRACER, pid, ...)
<br>2: seul un processus privilégié (possédant CAP_SYS_PTRACE) peut utiliser ptrace
<br>3: aucun processus ne peut utiliser ptrace
<br>Il est fortement recommandé d'utiliser au moins le niveau 1, mais le niveau peut différer en fonction des besoins.]]></description><link>wiki\configuration-noyau\r11-activer-et-configurer-le-lsm-yama.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R11 - Activer et configurer le LSM YAMA.md</guid><pubDate>Sun, 15 Dec 2024 22:58:05 GMT</pubDate></item><item><title><![CDATA[R12 - Paramétrer les options de configuration du réseau  IPv4]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_du_réseau" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_du_réseau</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>Cette mesure est différente des autres dans le sens où elle vient définir une liste d'option activable pour configurer au mieux la gestion et le comportement de l'IPv4<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>  
<br>Tags: <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_du_réseau" class="tag" target="_blank" rel="noopener nofollow">#Configuration_du_réseau</a> <a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a>
<br>Lynis - Ajout de cette mesure: Amélioration du score de un point - 66
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://linux-audit.com/linux-hardening-with-sysctl/" rel="noopener nofollow" class="external-link" href="https://linux-audit.com/linux-hardening-with-sysctl/" target="_blank">Comment modifier les paramètres sysctl</a>
<br><a data-tooltip-position="top" aria-label="https://wonderfall.space/linux-bricoles/" rel="noopener nofollow" class="external-link" href="https://wonderfall.space/linux-bricoles/" target="_blank">Tutoriel durcissement</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système:
<br>nano /etc/sysctl.conf
<br>
<br>Les lignes suivantes sont, pour la plupart déjà présentes dans le fichier. SImplement les décommenter et/ou changer leur valeurs comme suit:
<br>net.core.bpf_jit_harden=2
net.ipv4.ip_forward=0
net.ipv4.conf.all.accept_local=0
net.ipv4.conf.all.accept_redirects=0 
net.ipv4.conf.default.accept_redirects=0 
net.ipv4.conf.all.secure_redirects=0 
net.ipv4.conf.default.secure_redirects=0 
net.ipv4.conf.all.shared_media=0 
net.ipv4.conf.default.shared_media=0
net.ipv4.conf.all.accept_source_route=0 
net.ipv4.conf.default.accept_source_route=0
net.ipv4.conf.all.arp_filter=1
net.ipv4.conf.all.arp_ignore=2
net.ipv4.conf.all.route_localnet=0
net.ipv4.conf.all.drop_gratuitous_arp=1
net.ipv4.conf.default.rp_filter=1 
net.ipv4.conf.all.rp_filter=1
net.ipv4.conf.default.send_redirects=0
net.ipv4.conf.all.send_redirects=0
net.ipv4.icmp_ignore_bogus_error_responses=1
net.ipv4.ip_local_port_range=32768 65535
net.ipv4.tcp_rfc1337=1
net.ipv4.tcp_syncookies=1
<br>
Commentaire de l'ANSSI sur chacune des lignes:

<br>net.core.bpf_jit_harden=2: Atténuation de l'effet de dispersion du JIT noyau au coût d'un compromis sur les performances associées.
<br>net.ipv4.ip_forward=0: Pas de routage entre les interfaces. Cette option est spéciale et peut entrainer des modifications d'autres options. En plaçant cette option au plus tôt, on s'assure que la configuration des options suivantes ne change pas.
<br>net.ipv4.conf.all.accept_local=0: Considère comme invalides les paquets reçus de l'extérieur ayant comme source le réseau 127/8
<br>net.ipv4.conf.all.accept_redirects=0, net.ipv4.conf.default.accept_redirects=0, net.ipv4.conf.all.secure_redirects=0, net.ipv4.conf.default.secure_redirects=0, net.ipv4.conf.all.shared_media=0 et net.ipv4.conf.default.shared_media=0: Refuse la réception de paquet ICMP redirect. Le paramétrage suggéré de cette option est à considérer fortement dans le cas de routeurs qui ne doivent pas dépendre d'un élément extérieur pour déterminer le calcul d'une route. Même pour le cas de machines non-routeurs , ce paramétrage prémunit contre les détournements de trafic avec des paquets de type ICMP redirect
<br>net.ipv4.conf.all.accept_source_route=0 et net.ipv4.conf.default.accept_source_route=0: Refuse les informations d'en-têtes de source routing fournies par le paquet pour déterminer sa route.
<br>net.ipv4.conf.all.arp_filter=1: Empêche le noyau Linux de gérer la table ARP globalement. Par défaut , il peut répondre à une requête ARP d'une interface X avec les informations d'une interface Y. Ce comportement est problématique pour les routeurs et les équipements d'un système en haute disponibilité (VRRP...).
<br>net.ipv4.conf.all.arp_ignore=2: Ne répond aux sollicitations ARP que si l'adresse source et destination sont sur le même réseau et sur l'interface sur laquelle le paquet a été reçu. Il est à noter que la configuration de cette option est à étudier selon le cas d'usage.
<br>net.ipv4.conf.all.route_localnet=0: Refuse le routage de paquet dont l'adresse source ou destination est celle de la boucle locale. Cela interdit l'émission de paquet ayant comme source 127/8
<br>net.ipv4.conf.all.drop_gratuitous_arp=1: Ignore les sollicitations de type gratuitous ARP. Cette configuration est efficace contre les attaques de type ARP poisoning mais ne s'applique qu'en association avec un ou plusieurs proxy ARP maîtrisés. Elle peut également être problématique sur un réseau avec des équipements en haute disponibilité (VRRP...)
<br>net.ipv4.conf.default.rp_filter=1 et net.ipv4.conf.all.rp_filter=1: Vérifie que l'adresse source des paquets reçus sur une interface donnée aurait bien été contactée via cette même interface. À défaut , le paquet est ignoré. Selon l'usage , la valeur 1 peut permettre d'accroître la vérification à l'ensemble des interfaces , lorsque l'équipement est un routeur dont le calcul de routes est dynamique. Le lecteur intéressé est renvoyé à la RFC3704 pour tout complément concernant cette fonctionnalité.
<br>net.ipv4.conf.default.send_redirects=0 et net.ipv4.conf.all.send_redirects=0:  Cette option ne doit être mise à 1 que dans le cas d'un routeur , car pour ces équipements l'envoi de ICMP redirect est un comportement normal. Un équipement terminal n'a pas de raison de recevoir un flux dont il n'est pas destinataire et donc d'émettre un paquet ICMP redirect.
<br>net.ipv4.icmp_ignore_bogus_error_responses=1: Ignorer les réponses non conformes à la RFC 1122
<br>net.ipv4.ip_local_port_range=32768 65535: Augmenter la plage pour les ports éphémères
<br>net.ipv4.tcp_rfc1337=1: RFX 1337
<br>net.ipv4.tcp_syncookies=1: Utilise les SYN cookies. Cette option permet la prévention d'attaque de type SYN flood.

<br>
<br>Appliquer les mises à jour:
<br>sysctl --system
<br><br><br>Cet ensemblre de mesures, présente les options de configuration du réseau IPv4 pour un hôte « serveur » typique qui n’effectue pas de routage et ayant une configuration IPv4 minimaliste (adressage statique). La configuration est donc à adapter en fonction des utilisation du système.]]></description><link>wiki\configuration-noyau\r12-paramétrer-les-options-de-configuration-du-réseau-ipv4.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R12 - Paramétrer les options de configuration du réseau  IPv4.md</guid><pubDate>Sun, 15 Dec 2024 22:58:14 GMT</pubDate></item><item><title><![CDATA[R13 - Désactiver le plan IPv6]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_du_réseau" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_du_réseau</a> <a class="tag" href="?query=tag:Chargeur_de_démarrage" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Chargeur_de_démarrage</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>Le plan IPv6 est encore très peu utilisé et est très souvent activé par défaut. Le désactiver permettrait donc de réduire la surface d'attaque sans impacter les performances du système.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a>   
<br>Tags : <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_du_réseau" class="tag" target="_blank" rel="noopener nofollow">#Configuration_du_réseau</a>   <a href=".?query=tag:Chargeur_de_démarrage" class="tag" target="_blank" rel="noopener nofollow">#Chargeur_de_démarrage</a>  <a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a> 
<br>Lynis - Ajout de cette mesure: Aucun impact notable sur le score - 66
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/guide-cloisonnement-systeme" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/guide-cloisonnement-systeme" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://linux-audit.com/linux-hardening-with-sysctl/" rel="noopener nofollow" class="external-link" href="https://linux-audit.com/linux-hardening-with-sysctl/" target="_blank">Comment modifier les paramètres sysctl</a>
<br><a data-tooltip-position="top" aria-label="https://wonderfall.space/linux-bricoles/" rel="noopener nofollow" class="external-link" href="https://wonderfall.space/linux-bricoles/" target="_blank">Tutoriel durcissement</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br><br>
<br>Ouvrir le fichier de configuration du GRUB
<br>nano /etc/default/grub
<br>
<br>Trouver la ligne comportant GRUB_CMDLINE_LINUX_DEFAULT= et la modifier:
<br>GRUB_CMDLINE_LINUX="ipv6.disable=1"
<br>
Si la ligne contient d'autres options, ne pas les supprimer, simplement rajouter un espace et cette option à la liste
<br>
<br>Mettre à jour la configuration:
<br>update-grub
<br><br>
<br>Ouvrir le fichier de configuration système:
<br>nano /etc/sysctl.conf
<br>
<br>Si présentes, décommenter et/ou changer les valeurs comme suit. Sinon ajouter les lignes nécessaires:
<br>net.ipv6.conf.default.disable_ipv6=1
net.ipv6.conf.conf.all.disable_ipv6=1
net.ipv6.conf.default.accept_redirect=0
net.ipv6.conf.all.accept_rediects=0
<br>
<br>Appliquer les mises à jour:
<br>sysctl --system
<br><br>Dans certains cas, l'adressage IPv6 est utilisé, il est donc impératif de sauter cette mesure et de le laisser activé et configuré correctement. Les attaques par le protocole IPv6 sont désormais impossible. Il est également possible d'utiliser la commande Curl sans préciser l'utilisation d'une interface IPv4, permettant un certain gain de temps.]]></description><link>wiki\configuration-noyau\r13-désactiver-le-plan-ipv6.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R13 - Désactiver le plan IPv6.md</guid><pubDate>Sun, 15 Dec 2024 22:58:24 GMT</pubDate></item><item><title><![CDATA[R14 - Paramétrer les options de configuration des systèmes de fichiers]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_des_systèmes_de_fichiers" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_systèmes_de_fichiers</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>Définir le comportement du système de fichier et de tout ce qui en découle (Liens symboliques, politique d'accès, d'exécution, etc)<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a> 

<br>Recommandation de niveau intermédiaire. A mettre en œuvre dès que possible sur la plupart des systèmes dès que les recommandations de niveau minimal sont appliquées.


<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>  
<br>Tags : <a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> <a href=".?query=tag:Configuration_des_systèmes_de_fichiers" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_systèmes_de_fichiers</a> <a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a> 
<br>Lynis - Ajout de cette mesure: Amélioration du score de un point - 67
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/guide-cloisonnement-systeme" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/guide-cloisonnement-systeme" target="_blank">Guide ANSSI</a>
<br><a data-tooltip-position="top" aria-label="https://linux-audit.com/linux-hardening-with-sysctl/" rel="noopener nofollow" class="external-link" href="https://linux-audit.com/linux-hardening-with-sysctl/" target="_blank">Comment modifier les paramètres sysctl</a>
<br><a data-tooltip-position="top" aria-label="https://wonderfall.space/linux-bricoles/" rel="noopener nofollow" class="external-link" href="https://wonderfall.space/linux-bricoles/" target="_blank">Tutoriel durcissement</a>
<br><a data-tooltip-position="top" aria-label="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" rel="noopener nofollow" class="external-link" href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#boot-parameters" target="_blank">Guide complémentaire de durcissement</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système:
<br>nano /etc/sysctl.conf
<br>
<br>Si présentes, décommenter et/ou changer les valeurs comme suit. Sinon ajouter les lignes nécessaires:
<br>fs.suid_dumpable=0
fs.protected_fifos=2
fs.protected_regular=2
fs.protected_symlinks=1
fs.protected_hardinks=1
<br>
Commentaire de l'ANSSI sur chacune des lignes:

<br>fs.suid_dumpable = 0: Désactive la création de coredump pour les exécutables setuid. Notez qu'il est possible de désactiver tous les coredumps avec la configuration CONFIG_COREDUMP=n
<br>fs.protected_fifos=2 et fs.protected_regular=2: Disponible à partir de la version 4.19 du noyau Linux , permet d'interdire l'ouverture des FIFOS et des fichiers "réguliers" qui ne sont pas la propriété de l'utilisateur dans les dossiers sticky en écriture pour tout le monde.
<br>fs.protected_symlinks=1: Restreint la création de liens symboliques à des fichiers dont l'utilisateur est propriétaire. Cette option fait partie des mécanismes de prévention contre les vulnérabilités de la famille Time of Check - Time of Use
<br>fs.protected_hardinks=1: Restreint la création de liens durs à des fichiers dont l'utilisateur est propriétaire. Ce sysctl fait partie des mécanismes de prévention contre les vulnérabilités Time of Check - Time of Use, mais aussi contre la possibilité de conserver des accès à des fichiers obsolètes

<br>
<br>Appliquer les mises à jour:
<br>sysctl --system
<br><br><br>En plus d'être mentionnées dans le guide de l'ANSSI, ces mesures sont également recommandées dans l'audit système de Lynis.]]></description><link>wiki\configuration-noyau\r14-paramétrer-les-options-de-configuration-des-systèmes-de-fichiers.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R14 - Paramétrer les options de configuration des systèmes de fichiers.md</guid><pubDate>Sun, 15 Dec 2024 22:58:34 GMT</pubDate></item><item><title><![CDATA[R15 - Paramétrer les options de compilation pour la gestion de la mémoire]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Venir couper à la source, avant même la compilation, le maxium de vulnérabilité ultérieurement exploitables imputées à la getion de la mémoire.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Cette option a remplacé CONFIG_DEBUG_RODATA dans le noyau (&gt;=4.11) 
# qui était une dépendance de CONFIG_DEBUG_KERNEL 
CONFIG_STRICT_KERNEL_RWX=y 
# CONFIG_ARCH_OPTIONAL_KERNEL_RWX et CONFIG_ARCH_HAS_STRICT_KERNEL_RWX sont 
# des dépendances de CONFIG_STRICT_KERNEL_RWX 
CONFIG_ARCH_OPTIONAL_KERNEL_RWX=y 
CONFIG_ARCH_HAS_STRICT_KERNEL_RWX=y
# Vérifie et rapporte les permissions de mapping mémoire dangereuses , par 
# exemple , lorsque les pages noyau sont en écriture et sont exécutables. 
# Cette option n'est pas disponible sur l'ensemble des architectures 
# matérielles (x86 &gt;=4.4, arm64 &gt;=4.10, etc.). 
CONFIG_DEBUG_WX=y 
# Désactive le système de fichiers utilisé uniquement dans le cadre de 
# débogage. Protéger ce système de fichiers nécessite un travail 
# supplémentaire. 
CONFIG_DEBUG_FS=n 
# A partir de la version 4.18 du noyau , ces options ajoutent 
# -fstack -protector -strong à la compilation afin de renforcer le stack canary ,
# il est nécessaire d'avoir une version de GCC au moins égale à 4.9. 
# Avant la version 4.18 du noyau linux , il faut utiliser les options 
# CONFIG_CC_STACKPROTECTOR et CONFIG_CC_STACKPROTECTOR_STRONG 
CONFIG_STACKPROTECTOR=y 
CONFIG_STACKPROTECTOR_STRONG=y 
# Interdit l'accès direct à la mémoire physique. 
# En cas de besoin et uniquement dans ce cas, il est possible d'activer un 
# accès strict à la mémoire , limitant ainsi son accès , avec les options 
# CONFIG_STRICT_DEVMEM=y et CONFIG_IO_STRICT_DEVMEM=y 
#CONFIG_DEVMEM is not set 
# Détecte la corruption de la pile pendant l'appel à l'ordonnanceur 
CONFIG_SCHED_STACK_END_CHECK=y 
# Impose une vérification des limites du mapping mémoire du processus au 
# moment des copies de données. 
CONFIG_HARDENED_USERCOPY=y 
# Interdit de revenir à une vérification du mapping auprès de l'allocateur si 
# l'option précédente a échoué (&lt;=5.15) 
#CONFIG_HARDENED_USERCOPY_FALLBACK is not set 
# Ajout de pages de garde entre les piles noyau. Cela protège contre les effets 
# de bord des débordements de pile (cette option n'est pas supportée sur toutes 
# les architectures). 
CONFIG_VMAP_STACK=y 
# Vérifications exhaustives sur les compteurs de référence du noyau (&lt;=5.4) 
CONFIG_REFCOUNT_FULL=y 
# Vérifie les actions de recopie mémoire qui pourraient provoquer une corruption 
# de structure dans les fonctions noyau str*() et mem*(). Cette vérification est 
# effectuée à la compilation et à l'exécution. 
CONFIG_FORTIFY_SOURCE=y 
# Désactive l'usage dangereux de l'ACPI, pouvant entrainer une écriture directe 
# en mémoire physique. 
#CONFIG_ACPI_CUSTOM_METHOD is not set 
# Interdit tout accès direct à la mémoire du noyau à partir du userspace (&lt;=5.12) 
#CONFIG_DEVKMEM is not set 
# Interdit la fourniture de la disposition de l'image noyau 
#CONFIG_PROC_KCORE is not set 
# Désactive la rétrocompatibilité VDSO, qui rend impossible l'usage de l'ASLR 
#CONFIG_COMPAT_VDSO is not set 
# Empèche les utilisateurs non privilégiés de récupérer des adresses noyau 
# avec dmesg(8) 
CONFIG_SECURITY_DMESG_RESTRICT=y 
# Active les retpoline qui sont nécessaires pour se protéger de Spectre v2 
# GCC &gt;= 7.3.0 est requis. 
CONFIG_RETPOLINE=y 
# Désactive la table vsyscall. Elle n'est plus requise par la libc et est une 
# source potentielle de ROP gadgets. 
CONFIG_LEGACY_VSYSCALL_NONE=y 
CONFIG_LEGACY_VSYSCALL_EMULATE=n 
CONFIG_LEGACY_VSYSCALL_XONLY=n 
CONFIG_X86_VSYSCALL_EMULATION=n
<br><br><br>
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r15-paramétrer-les-options-de-compilation-pour-la-gestion-de-la-mémoire.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R15 - Paramétrer les options de compilation pour la gestion de la mémoire.md</guid><pubDate>Sun, 15 Dec 2024 22:58:46 GMT</pubDate></item><item><title><![CDATA[R16 - Paramétrer les options de compilation pour les structures de données du noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Veille_et_maintenance" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Veille_et_maintenance</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Détecter les tentatives de corruption des structures mémoires du noyau pour prendre les mesures adéquates et, dans le pire des cas, arrêter complètement le système en cas d'erreur non récupérable.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Veille_et_maintenance" class="tag" target="_blank" rel="noopener nofollow">#Veille_et_maintenance</a>  
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Vérifie les structures de gestion des autorisations. 
CONFIG_DEBUG_CREDENTIALS=y 
# Vérifie les structures de notification. 
CONFIG_DEBUG_NOTIFIERS=y 
# Vérifie les listes noyau. CONFIG_DEBUG_LIST=y 
# Vérifie les tables de Scatter -Gather du noyau. 
CONFIG_DEBUG_SG=y 
# Génère un appel à BUG() en cas de détection de corruption. 
CONFIG_BUG_ON_DATA_CORRUPTION=y
<br><br><br>
<br>Une attaque entraînant la corruption de la mémoire du noyau est suffisamment avancée pour potentiellement permettre l’exécution contrôlée de code en mode superviseur sur l’équipement ou la désactivation de mécanismes de protection génériques
<br>
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r16-paramétrer-les-options-de-compilation-pour-les-structures-de-données-du-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R16 - Paramétrer les options de compilation pour les structures de données du noyau.md</guid><pubDate>Sun, 15 Dec 2024 22:58:56 GMT</pubDate></item><item><title><![CDATA[R17 - Paramétrer les options de compilation pour l'allocateur mémoire]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Renforcer les mesures de détection et de réaction pour prévenir au maximum des attaques visant à exploiter l'allocateur de mémoire.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Positionne les informations de chaînage des blocs libres de l'allocateur de 
# manière aléatoire. 
CONFIG_SLAB_FREELIST_RANDOM=y 
# CONFI_SLAB est une dépendance de CONFIG_SLAB_FREELIST_RANDOM 
CONFIG_SLUB=y 
# Protège les métadonnées de l'allocateur en intégrité. 
CONFIG_SLAB_FREELIST_HARDENED=y 
# A partir de la version 4.13 du noyau , cette option désactive le merge des 
# caches 
SLAB CONFIG_SLAB_MERGE_DEFAULT=n 
# Active la vérification des structures de l'allocateur mémoire et réinitialise 
# à zéro les zones allouées à leur libération (nécessite l'activation de 
# l'option de configuration de la mémoire page_poison=on ajoutée à la liste des 
# paramètres du noyau lors du démarrage). Il est préférable d'utiliser 
# l'option de configuration slub_debug de la mémoire ajoutée à la liste des 
# paramètres du noyau lors du démarrage car elle permet une gestion plus fine 
# du slub debug. 
CONFIG_SLUB_DEBUG=y 26
# Nettoie les pages mémoire au moment de leur libération. 
CONFIG_PAGE_POISONING=y 
# Nettoyage en profondeur désactivé. Cette option a un coût important; 
# cependant si l'impact en performance est compatible avec le besoin 
# opérationnel de l'équipement il est recommandé de l'activer (&lt;=5.10) 
CONFIG_PAGE_POISONING_NO_SANITY=y 
# Le nettoyage des pages mémoire est effectué avec une réécriture de zéros en 
# lieu et place des données (&lt;=5.10) 
CONFIG_PAGE_POISONING_ZERO=y 
# Désactive la rétrocompatibilité avec brk() qui rend impossible une 
# implémentation de brk() avec l'ASLR. 
#CONFIG_COMPAT_BRK is not set
<br><br><br>
<br>L'allocateur mémoire est une cible classique des attaques, il est donc important de prendre au sérieux son renforcement
<br>
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r17-paramétrer-les-options-de-compilation-pour-l&apos;allocateur-mémoire.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R17 - Paramétrer les options de compilation pour l&apos;allocateur mémoire.md</guid><pubDate>Sun, 15 Dec 2024 22:59:04 GMT</pubDate></item><item><title><![CDATA[R18 - Paramétrer les options de compilation pour la gestion des modules noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Forcer la signature des modules utilisés et la mise en place de contrôle de signature des modules qui seront importés.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Activation du support des modules 
CONFIG_MODULES=y 
# Cette option a remplacé CONFIG_DEBUG_SET_MODULE_RONX dans le noyau (&gt;=4.11) 
CONFIG_STRICT_MODULE_RWX=y 
# Les modules doivent être signés. Attention , les modules ne doivent pas être 
# strippés après signature. 
CONFIG_MODULE_SIG=y 
# Empèche le chargement des modules non signés ou signés avec une clé qui ne 
# nous appartient pas. 
CONFIG_MODULE_SIG_FORCE=y 
# Activer CONFIG_MODULE_SIG_ALL permet de signer tous les modules 
# automatiquement pendant l'étape "make modules_install", sans cette option 
# les modules doivent être signés manuellement en utilisant le script 
# scripts/sign-file. L'option CONFIG_MODULE_SIG_ALL dépend de CONFIG_MODULE_SIG 
# et CONFIG_MODULE_SIG_FORCE , elles doivent donc être activées. 
CONFIG_MODULE_SIG_ALL=y 
# La signature des modules utilise SHA512 comme fonction de hash 
CONFIG_MODULE_SIG_SHA512=y 
CONFIG_MODULE_SIG_HASH="sha512" 
# Indique le chemin vers le fichier contenant à la fois la clé privée et son 
# certificat X.509 au format PEM utilisé pour la signature des modules , 
# relatif à la racine du noyau.
CONFIG_MODULE_SIG_KEY="certs/signing_key.pem"
<br><br><br>
<br>Les modules sont souvent très utiles et de diverses natures. Il n'est donc ici pas question des les désactiver complètement mais de forcer un processus de signature pour connaître et reconnaître les modules légitimes et les modules illégitimes.
<br>
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r18-paramétrer-les-options-de-compilation-pour-la-gestion-des-modules-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R18 - Paramétrer les options de compilation pour la gestion des modules noyau.md</guid><pubDate>Sun, 15 Dec 2024 22:59:16 GMT</pubDate></item><item><title><![CDATA[R19 - Paramétrer les options de compilation pour les évènements anormaux]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Veille_et_maintenance" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Veille_et_maintenance</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Définir un set d'action à entreprendre dès la détection d'un comportement anormal de la part d'un processus légitime.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Veille_et_maintenance" class="tag" target="_blank" rel="noopener nofollow">#Veille_et_maintenance</a>  
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle 
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Émet un rapport sur les conditions d'appel à la macro noyau BUG() 
# et tue le processus à l'origine de l'appel. Ne pas positionner cette variable 
# peut passer sous silence un certain nombre d'erreurs critiques. 
CONFIG_BUG=y 
# Arrête le système en cas d'erreur critique pour couper court à tout comportement 
# erroné. 
CONFIG_PANIC_ON_OOPS=y 
# Empêche le redémarrage de la machine suite à un panic ce qui coupe court à 
# toute tentative d'attaque par force brute. Ceci a évidemment un impact fort 
# sur des serveurs en production. 
CONFIG_PANIC_TIMEOUT=-1
<br><br><br>
<br>Une grande majorité des attaques passe par l'utilisation d'un processus légitime afin d'exécuter un bout de code ou de programme complet. Pour des raisons évidentes, ces exécutions ne font pas parties du comportement dit "normal" de ces processus. C'est ce qui peut nous permettre de pousser le système à lever un drapeau spécifique et d'entreprendre une réaction en conséquence.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r19-paramétrer-les-options-de-compilation-pour-les-évènements-anormaux.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R19 - Paramétrer les options de compilation pour les évènements anormaux.md</guid><pubDate>Sun, 15 Dec 2024 22:59:28 GMT</pubDate></item><item><title><![CDATA[R20 - Paramétrer les options de compilation pour les primitives de sécurité du noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Activer une certaine protection des processus applicatifs<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Active la possibilité de filtrer les appels système faits par une 
# application. 
CONFIG_SECCOMP=y 
# Active la possibilité d'utiliser des script BPF (Berkeley Packet Filter). 
CONFIG_SECCOMP_FILTER=y 
# Active les primitives de sécurité du noyau Linux , nécessaire pour les LSM. 
CONFIG_SECURITY=y 
# Active Yama, qui permet de limiter simplement l'usage de l'appel système 
# ptrace(). Une fois les modules de sécurité utilisés par le système 
# sélectionné , il convient de désactiver le support des autres modules de 
# sécurité dans le noyau afin de réduire la surface d'attaque. 
CONFIG_SECURITY_YAMA=y 
# Assure que les structures noyau associées aux LSM sont toujours mappées en 
# lecture seule après le démarrage du système. Dans le cas où SELinux est 
# utilisé , il faut s'assurer que CONFIG_SECURITY_SELINUX_DISABLE is not set, 
# pour que cette option soit disponible. Il n'est alors plus possible de 
# désactiver un LSM une fois le noyau démarré. Il est en revanche encore 
# possible de le faire en modifiant la ligne de commande du noyau. Pour le 
# noyau 4.18 les LSM présents sont: AppArmor , LoadPin , SELinux , Smack , TOMOYO 
# et Yama. 
#CONFIG_SECURITY_WRITABLE_HOOKS is not set
<br><br><br>
<br>Les traces d'exécution d'un processus applicatif peut permettre à un attaquant de connaître et de suivre l'ensemble des opérations effectuées par un processus. Ce type de mesure permet de restreindre l'accès aux journaux et de prévenir d'une prise de contrôle par exploitation séquentielle de processus.
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r20-paramétrer-les-options-de-compilation-pour-les-primitives-de-sécurité-du-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R20 - Paramétrer les options de compilation pour les primitives de sécurité du noyau.md</guid><pubDate>Sun, 15 Dec 2024 22:59:39 GMT</pubDate></item><item><title><![CDATA[R21 - Paramétrer les options de compilation pour les plugins du compilateur]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Améliorer la robustesse du compilateur GCC en activant de splugins spécifiques<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, décommenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Active le support des plugins du compilateur (implique l'usage de GCC). 
CONFIG_GCC_PLUGINS=y 
# Amplifie la génération d'entropie au démarrage de l'équipement pour ceux 
# ayant des sources d'entropie inappropriées 
CONFIG_GCC_PLUGIN_LATENT_ENTROPY=y 
# Nettoie le contenu de la pile au moment de l'appel système exit. 
CONFIG_GCC_PLUGIN_STACKLEAK=y 
# Impose l'initialisation des structures en mémoire pour éviter la fuite de 
# données par superposition avec une ancienne structure. 
CONFIG_GCC_PLUGIN_STRUCTLEAK=y 
# Globalisation de l'option précédente au cas du passage de structure par 
# référence entre fonction si celles -ci ont des champs non initialisés. 
CONFIG_GCC_PLUGIN_STRUCTLEAK_BYREF_ALL=y 
# Construit un plan mémoire aléatoire pour les structures système du noyau. 
# Cette option a un impact fort sur les performances. L'option 
# CONFIG_GCC_PLUGIN_RANDSTRUCT_PERFORMANCE=y est à utiliser en substitution si 
# cet impact n'est pas acceptable. 
CONFIG_GCC_PLUGIN_RANDSTRUCT=y
<br><br><br>
<br>GCC est le compilateur par défaut de Linux, et est donc par définition très utilisé dans le système. C'est un composant à ne pas négliger, puisqu'il est au coeur de beaucoup d'attaques, expliquant l'intérrêt de ces plugins.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r21-paramétrer-les-options-de-compilation-pour-les-plugins-du-compilateur.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R21 - Paramétrer les options de compilation pour les plugins du compilateur.md</guid><pubDate>Sun, 15 Dec 2024 22:59:51 GMT</pubDate></item><item><title><![CDATA[R22 - Paramétrer les options de compilation pour la pile réseau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Réduire la surface d'attaque au niveau du réseau<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a>  
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter, commenter et/ou changer leur valeurs des lignes en question comme suit:
<br># Désactive le plan IPv6 
#CONFIG_IPV6 option set. 
# Permet de prévenir les attaques de type SYN flood. 
CONFIG_SYN_COOKIES=y
<br><br><br>
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r22-paramétrer-les-options-de-compilation-pour-la-pile-réseau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R22 - Paramétrer les options de compilation pour la pile réseau.md</guid><pubDate>Sun, 15 Dec 2024 22:59:58 GMT</pubDate></item><item><title><![CDATA[R23 - Paramétrer les options de compilation pour divers comportements du noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> 
 <br><br>Réduire la surface d'attaque en restreignant de scomportements inutiles du noyau<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a>  
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter et/ou changer leur valeurs des lignes en question comme suit:
<br># Interdit l'exécution d'une nouvelle image noyau à chaud. 
#CONFIG_KEXEC is not set 
# Interdit le passage en mode hibernation , qui permet de substituer l'image 
# noyau à son insu. 
#CONFIG_HIBERNATION is not set 
# Désactive le support de format binaire arbitraire. 
#CONFIG_BINFMT_MISC is not set 
# Impose l'utilisation des ptys modernes (devpts) dont on peut contrôler le 
# nombre et l'usage. 
#CONFIG_LEGACY_PTYS is not set 
# Si le support des modules n'est pas absolument nécessaire celui -ci doit être 
# désactivé. 
#CONFIG_MODULES is not set
<br><br><br>
<br>Le noyau est par défaut conçu avec différents comportements visant à améliorer desperformances ou proposer de nouelles fonctionnalité à l'utiliateur. Si ces mesures ne sont pas incontournables à l'utilisation du sytème, il est ainsi préférable de les désactiver.
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r23-paramétrer-les-options-de-compilation-pour-divers-comportements-du-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R23 - Paramétrer les options de compilation pour divers comportements du noyau.md</guid><pubDate>Sun, 15 Dec 2024 23:00:06 GMT</pubDate></item><item><title><![CDATA[R24 - Paramétrer les options de compilation spécifiques aux architectures 32bits]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_spécifiques_aux_architectures_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_spécifiques_aux_architectures_matérielle</a> 
 <br><br>Activer un set de contre-mesure pour durcir le noyau dans un cadre très spécifique.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>   
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_spécifiques_aux_architectures_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_spécifiques_aux_architectures_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter et/ou changer leur valeurs des lignes en question comme suit:
<br># Active le support des extensions d'adresse physique , ce qui est un prérequis 
# pour le support du bit de permission NX dans la table des pages qui permet de 
# marquer certaines pages comme non exécutables. 
CONFIG_HIGHMEM64G=y CONFIG_X86_PAE=y 
# Interdit l'utilisation d'adresses mémoire en dessous d'une certaine valeur 
# (contre -mesure contre les null pointer dereference). 
CONFIG_DEFAULT_MMAP_MIN_ADDR=65536 
# Rend non prédictible l'adresse de base du noyau. Cette option complexifie la 
# tâche d'un attaquant. 
CONFIG_RANDOMIZE_BASE=y
<br><br><br>
<br>Ces mesures sont spécifiques à une utilisation exclusive d'une architecture 32bits.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r24-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-32bits.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R24 - Paramétrer les options de compilation spécifiques aux architectures 32bits.md</guid><pubDate>Sun, 15 Dec 2024 23:00:13 GMT</pubDate></item><item><title><![CDATA[R25 - Paramétrer les options de compilation spécifiques aux architectures x86_64 bits]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_spécifiques_aux_architectures_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_spécifiques_aux_architectures_matérielle</a> 
 <br><br>Activer un set de contre-mesure pour durcir le noyau dans un cadre très spécifique.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>   
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_spécifiques_aux_architectures_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_spécifiques_aux_architectures_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter et/ou changer leur valeurs des lignes en question comme suit:
<br># Activate le mode complet 64 bits. 
CONFIG_X86_64=y 
# Interdit l'utilisation d'adresses mémoire en dessous d'une certaine valeur 
# (contre -mesure contre les null pointer dereference). 
CONFIG_DEFAULT_MMAP_MIN_ADDR=65536 
# Rend non prédictible l'adresse de base du noyau , cette option complexifie 
# la tâche d'un attaquant. 
CONFIG_RANDOMIZE_BASE=y 
# Rend non prédictible l'adresse à laquelle les composants du noyau sont 
# exposés dans l'espace d'adressage des processus. 
CONFIG_RANDOMIZE_MEMORY=y 
# Contre -mesure à l'attaque Meltdown. 
CONFIG_PAGE_TABLE_ISOLATION=y 
# Désactive la rétro -compatibilité 32 bits, ce qui permet de réduire la 
# surface d'attaque mais empêche d'exécuter des binaires 32 bits. 
#CONFIG_IA32_EMULATION is not set 
# Interdit la surcharge par processus de la Local Descriptor Table 
# (mécanisme lié à l'usage de la segmentation). 
#CONFIG_MODIFY_LDT_SYSCALL is not set
<br><br><br>
<br>Ces mesures sont spécifiques à une utilisation exclusive d'une architecture x86_64bits.
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r25-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-x86_64-bits.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R25 - Paramétrer les options de compilation spécifiques aux architectures x86_64 bits.md</guid><pubDate>Sun, 15 Dec 2024 23:00:21 GMT</pubDate></item><item><title><![CDATA[R26 - Paramétrer les options de compilation spécifiques aux architectures ARM]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_spécifiques_aux_architectures_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_spécifiques_aux_architectures_matérielle</a> 
 <br><br>Activer un set de contre-mesure pour durcir le noyau dans un cadre très spécifique.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>   
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_spécifiques_aux_architectures_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_spécifiques_aux_architectures_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter et/ou changer leur valeurs des lignes en question comme suit:
<br># Interdit l'utilisation d'adresses mémoire en dessous d'une certaine valeur 
# (contre -mesure contre les null pointer dereference).
CONFIG_DEFAULT_MMAP_MIN_ADDR=32768 
# Maximise la taille de la mémoire virtuelle des processus (et de l'ASLR 
# afférent). 
CONFIG_VMSPLIT_3G=y 
# Interdit les mappings mémoire RWX. 
CONFIG_STRICT_MEMORY_RWX=y 
# Interdit les accès par le noyau à la mémoire utilisateur (mécanisme 
# équivalent sur ARM à SMAP sur x86_64). 
CONFIG_CPU_SW_DOMAIN_PAN=y 
# Cette option de compatibilité avec l'ancienne ABI ARM est dangereuse et 
# ouvre la voie à diverses attaques. 
#CONFIG_OABI_COMPAT is unset
<br><br><br>
<br>Ces mesures sont spécifiques à une utilisation exclusive d'une architecture ARM.
<br>Certaines options ici, sont définies de la manière suivante: # OPTION is not set. Cette définition est une définition particulière puisqu'elle permet en fait d'explicitement désactiver une option.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r26-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-arm.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R26 - Paramétrer les options de compilation spécifiques aux architectures ARM.md</guid><pubDate>Sun, 15 Dec 2024 23:00:30 GMT</pubDate></item><item><title><![CDATA[R27 - Paramétrer les options de compilation spécifiques aux architectures ARM 64bits]]></title><description><![CDATA[<a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_spécifiques_aux_architectures_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_spécifiques_aux_architectures_matérielle</a> 
 <br><br>Activer un set de contre-mesure pour durcir le noyau dans un cadre très spécifique.<br><br><br>
<br>Niveau ANSSI:  <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a>  

<br>Recommandation de niveau élevé. A ne mettre en œuvre que si les ressources internes ont les compétences et le temps nécessaire pour assurer leur maintien régulier sous peine de dégrader la sécurité du système. Celles-ci peuvent cependant apporter un gain de sécurité important.


<br>Principe associé:   <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>   
<br>Tags: <a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> <a href=".?query=tag:Configuration_spécifiques_aux_architectures_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_spécifiques_aux_architectures_matérielle</a> 
<br>Lynis - Impossibilité de test sur machine virtuelle
<br><br><br>
<br><a data-tooltip-position="top" aria-label="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">Guide ANSSI</a>
<br><br><br>
<br>Ouvrir le fichier de configuration système présent à la racine des sources du noyau:
<br>.config
<br>
<br>Ajouter et/ou changer leur valeurs des lignes en question comme suit:
<br># Interdit l'utilisation d'adresses mémoire en dessous d'une certaine valeur 
# (contre -mesure contre les null pointer dereference). 
CONFIG_DEFAULT_MMAP_MIN_ADDR=32768 
# Rend non prédictible l'adresse de base du noyau , cette option complexifie 
# la tâche d'un attaquant. L'entropie nécessaire à la génération de l'aléa 
# doit être fournie par l'UEFI ou, à défaut , par le chargeur de démarrage. 
CONFIG_RANDOMIZE_BASE=y 
# Interdit les accès par le noyau à la mémoire utilisateur (mécanisme 
# équivalent sur ARM à SMAP sur 86_64). 
CONFIG_ARM64_SW_TTBR0_PAN=y 
# Contre mesure à l'attaque Meltdown. 
CONFIG_UNMAP_KERNEL_AT_EL0=y
<br><br><br>
<br>Ces mesures sont spécifiques à une utilisation exclusive d'une architecture ARM 64bits.
<br>Les commentaires de l'ANSSI ont cette fois été laissés pour une raison de compréhension. Jouant avec des options de compilation du noyau, il est à notre sens important de les laisser dans le fichier de compilation afin de garder une trace des modifications apportées et du pourquoi. A l'inverse des modifications dynamiques, ces modifications là ne seront ultérieurement plus accessible, et les  commentaires ne pourront pas non plus donner d'information à un potentiel attaquant.
]]></description><link>wiki\configuration-noyau\r27-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-arm-64bits.html</link><guid isPermaLink="false">Wiki/Configuration noyau/R27 - Paramétrer les options de compilation spécifiques aux architectures ARM 64bits.md</guid><pubDate>Sun, 15 Dec 2024 23:00:39 GMT</pubDate></item><item><title><![CDATA[Sommaire - Configuration noyau]]></title><description><![CDATA[<a class="tag" href="?query=tag:Configuration_dynamique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_dynamique</a> <a class="tag" href="?query=tag:Configuration_de_la_mémoire" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_de_la_mémoire</a> <a class="tag" href="?query=tag:Configuration_du_noyau" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_du_noyau</a> <a class="tag" href="?query=tag:Configuration_des_processus" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_processus</a> <a class="tag" href="?query=tag:Configuration_du_réseau" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_du_réseau</a> <a class="tag" href="?query=tag:Configuration_des_systèmes_de_fichiers" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_systèmes_de_fichiers</a> <a class="tag" href="?query=tag:Configuration_statique" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_statique</a> <a class="tag" href="?query=tag:Configuration_indépendante_de_la_cible_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_indépendante_de_la_cible_matérielle</a> <a class="tag" href="?query=tag:Configuration_spécifiques_aux_architectures_matérielle" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_spécifiques_aux_architectures_matérielle</a> <a class="tag" href="?query=tag:Chargeur_de_démarrage" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Chargeur_de_démarrage</a> <a class="tag" href="?query=tag:Sysctl" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sysctl</a> 
 <br><br>
<br><a data-href="R5 - Configuration d'un mot de passe pour le chargeur de démarrage" href="wiki\configuration-noyau\r5-configuration-d'un-mot-de-passe-pour-le-chargeur-de-démarrage.html" class="internal-link" target="_self" rel="noopener nofollow">R5 - Configuration d'un mot de passe pour le chargeur de démarrage</a>
<br><a data-href="R6 - Protéger les paramètres de ligne de commande du noyau et l'initramfs" href="wiki\configuration-noyau\r6-protéger-les-paramètres-de-ligne-de-commande-du-noyau-et-l'initramfs.html" class="internal-link" target="_self" rel="noopener nofollow">R6 - Protéger les paramètres de ligne de commande du noyau et l'initramfs</a>
<br>
<br><a data-href="R7 - Activation de l'IOMMU" href="wiki\configuration-noyau\r7-activation-de-l'iommu.html" class="internal-link" target="_self" rel="noopener nofollow">R7 - Activation de l'IOMMU</a>
<br><a data-href="R8 - Paramétrer les options de configuration de la mémoire" href="wiki\configuration-noyau\r8-paramétrer-les-options-de-configuration-de-la-mémoire.html" class="internal-link" target="_self" rel="noopener nofollow">R8 - Paramétrer les options de configuration de la mémoire</a>
<br><a data-href="R9 - Paramétrer les options de configuration du noyau" href="wiki\configuration-noyau\r9-paramétrer-les-options-de-configuration-du-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">R9 - Paramétrer les options de configuration du noyau</a>
<br><a data-href="R10 - Désactiver le chargement des modules noyau" href="wiki\configuration-noyau\r10-désactiver-le-chargement-des-modules-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">R10 - Désactiver le chargement des modules noyau</a>
<br><a data-href="R11 - Activer et configurer le LSM YAMA" href="wiki\configuration-noyau\r11-activer-et-configurer-le-lsm-yama.html" class="internal-link" target="_self" rel="noopener nofollow">R11 - Activer et configurer le LSM YAMA</a>
<br><a data-href="R12 - Paramétrer les options de configuration du réseau  IPv4" href="wiki\configuration-noyau\r12-paramétrer-les-options-de-configuration-du-réseau-ipv4.html" class="internal-link" target="_self" rel="noopener nofollow">R12 - Paramétrer les options de configuration du réseau  IPv4</a>
<br><a data-href="R13 - Désactiver le plan IPv6" href="wiki\configuration-noyau\r13-désactiver-le-plan-ipv6.html" class="internal-link" target="_self" rel="noopener nofollow">R13 - Désactiver le plan IPv6</a>
<br><a data-href="R14 - Paramétrer les options de configuration des systèmes de fichiers" href="wiki\configuration-noyau\r14-paramétrer-les-options-de-configuration-des-systèmes-de-fichiers.html" class="internal-link" target="_self" rel="noopener nofollow">R14 - Paramétrer les options de configuration des systèmes de fichiers</a>
<br><a data-href="R15 - Paramétrer les options de compilation pour la gestion de la mémoire" href="wiki\configuration-noyau\r15-paramétrer-les-options-de-compilation-pour-la-gestion-de-la-mémoire.html" class="internal-link" target="_self" rel="noopener nofollow">R15 - Paramétrer les options de compilation pour la gestion de la mémoire</a>
<br><a data-href="R16 - Paramétrer les options de compilation pour les structures de données du noyau" href="wiki\configuration-noyau\r16-paramétrer-les-options-de-compilation-pour-les-structures-de-données-du-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">R16 - Paramétrer les options de compilation pour les structures de données du noyau</a>
<br><a data-href="R17 - Paramétrer les options de compilation pour l'allocateur mémoire" href="wiki\configuration-noyau\r17-paramétrer-les-options-de-compilation-pour-l'allocateur-mémoire.html" class="internal-link" target="_self" rel="noopener nofollow">R17 - Paramétrer les options de compilation pour l'allocateur mémoire</a>
<br><a data-href="R18 - Paramétrer les options de compilation pour la gestion des modules noyau" href="wiki\configuration-noyau\r18-paramétrer-les-options-de-compilation-pour-la-gestion-des-modules-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">R18 - Paramétrer les options de compilation pour la gestion des modules noyau</a>
<br><a data-href="R19 - Paramétrer les options de compilation pour les évènements anormaux" href="wiki\configuration-noyau\r19-paramétrer-les-options-de-compilation-pour-les-évènements-anormaux.html" class="internal-link" target="_self" rel="noopener nofollow">R19 - Paramétrer les options de compilation pour les évènements anormaux</a>
<br><a data-href="R20 - Paramétrer les options de compilation pour les primitives de sécurité du noyau" href="wiki\configuration-noyau\r20-paramétrer-les-options-de-compilation-pour-les-primitives-de-sécurité-du-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">R20 - Paramétrer les options de compilation pour les primitives de sécurité du noyau</a>
<br><a data-href="R21 - Paramétrer les options de compilation pour les plugins du compilateur" href="wiki\configuration-noyau\r21-paramétrer-les-options-de-compilation-pour-les-plugins-du-compilateur.html" class="internal-link" target="_self" rel="noopener nofollow">R21 - Paramétrer les options de compilation pour les plugins du compilateur</a>
<br><a data-href="R22 - Paramétrer les options de compilation pour la pile réseau" href="wiki\configuration-noyau\r22-paramétrer-les-options-de-compilation-pour-la-pile-réseau.html" class="internal-link" target="_self" rel="noopener nofollow">R22 - Paramétrer les options de compilation pour la pile réseau</a>
<br><a data-href="R23 - Paramétrer les options de compilation pour divers comportements du noyau" href="wiki\configuration-noyau\r23-paramétrer-les-options-de-compilation-pour-divers-comportements-du-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">R23 - Paramétrer les options de compilation pour divers comportements du noyau</a>
<br><a data-href="R24 - Paramétrer les options de compilation spécifiques aux architectures 32bits" href="wiki\configuration-noyau\r24-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-32bits.html" class="internal-link" target="_self" rel="noopener nofollow">R24 - Paramétrer les options de compilation spécifiques aux architectures 32bits</a>
<br><a data-href="R25 - Paramétrer les options de compilation spécifiques aux architectures x86_64 bits" href="wiki\configuration-noyau\r25-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-x86_64-bits.html" class="internal-link" target="_self" rel="noopener nofollow">R25 - Paramétrer les options de compilation spécifiques aux architectures x86_64 bits</a>
<br><a data-href="R26 - Paramétrer les options de compilation spécifiques aux architectures ARM" href="wiki\configuration-noyau\r26-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-arm.html" class="internal-link" target="_self" rel="noopener nofollow">R26 - Paramétrer les options de compilation spécifiques aux architectures ARM</a>
<br><a data-href="R27 - Paramétrer les options de compilation spécifiques aux architectures ARM 64bits" href="wiki\configuration-noyau\r27-paramétrer-les-options-de-compilation-spécifiques-aux-architectures-arm-64bits.html" class="internal-link" target="_self" rel="noopener nofollow">R27 - Paramétrer les options de compilation spécifiques aux architectures ARM 64bits</a>
<br><br>
<br><a href=".?query=tag:Configuration_dynamique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_dynamique</a> 

<br><a href=".?query=tag:Configuration_de_la_mémoire" class="tag" target="_blank" rel="noopener nofollow">#Configuration_de_la_mémoire</a>
<br><a href=".?query=tag:Configuration_du_noyau" class="tag" target="_blank" rel="noopener nofollow">#Configuration_du_noyau</a>
<br><a href=".?query=tag:Configuration_des_processus" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_processus</a> 
<br><a href=".?query=tag:Configuration_du_réseau" class="tag" target="_blank" rel="noopener nofollow">#Configuration_du_réseau</a>  
<br><a href=".?query=tag:Configuration_des_systèmes_de_fichiers" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_systèmes_de_fichiers</a> 


<br><a href=".?query=tag:Configuration_statique" class="tag" target="_blank" rel="noopener nofollow">#Configuration_statique</a> 

<br><a href=".?query=tag:Configuration_indépendante_de_la_cible_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_indépendante_de_la_cible_matérielle</a> 
<br><a href=".?query=tag:Configuration_spécifiques_aux_architectures_matérielle" class="tag" target="_blank" rel="noopener nofollow">#Configuration_spécifiques_aux_architectures_matérielle</a> 


<br><a href=".?query=tag:Chargeur_de_démarrage" class="tag" target="_blank" rel="noopener nofollow">#Chargeur_de_démarrage</a> 
<br><a href=".?query=tag:Sysctl" class="tag" target="_blank" rel="noopener nofollow">#Sysctl</a> 
<br>]]></description><link>wiki\configuration-noyau\sommaire-configuration-noyau.html</link><guid isPermaLink="false">Wiki/Configuration noyau/Sommaire - Configuration noyau.md</guid><pubDate>Sun, 15 Dec 2024 22:32:13 GMT</pubDate></item><item><title><![CDATA[R28 - Partitionnement type]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Partitionnement" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Partitionnement</a> 
 <br><br>Le partitionnement vise à améliorer la sécurité et la stabilité d'un système linux en isolant différentes parties du système de fichiers. Cela empêche qu'une partition saturée ou compromise affecte les autres parties du système. L'utilisation d'options de montage (comme nosuid, nodev et noexec) limite également les possibilités d'exploits ou de mauvais usages.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>
<br>Lynis - Ne peut pas être évalué
<br>Tag : <a href=".?query=tag:Partitionnement" class="tag" target="_blank" rel="noopener nofollow">#Partitionnement</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Partitionnement<br><br><br>Les partitions dans un systèmes linux doivent être distinctes et avoir leurs propres fonctionnalités. Il est important de suivre cette configuration normé :<br><br>Il est possible d'automatiser la création des partitions à la création de la machine, en choisissant l'option de séparation des dossiers.<br>Si l'option n'a pas été faite, il est possible de le faire en configurant le fichier /etc/fstab : <br>UUID=1234-5678   /boot     ext4   nosuid,nodev,noexec,noauto    0 2
UUID=1234-5679   /tmp      tmpfs  nosuid,nodev,noexec           0 0
UUID=1234-5680   /var/log  ext4   nosuid,nodev,noexec           0 2
UUID=1234-5681   /srv      ext4   nosuid,nodev,noexec           0 2
<br>Ensuite, utilisez fdisk, parted, ou un outil graphique pour créer des partitions dédiées.<br>
<br>Exemples de commandes :
<br>parted /dev/sda mkpart primary ext4 1MiB 10GiB
mkfs.ext4 /dev/sda1
<br><br><br>Cette mesure en renforçant l'isolation permet de limiter les impacts en cas de saturation ou d'exploitation. Les options de montage associés réduisent les surfaces d'attaque (empêchent les fichiers exécutables dans /tmp ou les esclaves via setuid dans /var). Il est également possible de personnaliser les besoins nécessaires pour chaque partition, en fonction des services  installés sur la machine (WEB, FTP, logs, utilisateurs).]]></description><link>wiki\configuration-système\r28-partitionnement-type.html</link><guid isPermaLink="false">Wiki/Configuration système/R28 - Partitionnement type.md</guid><pubDate>Sun, 15 Dec 2024 23:02:25 GMT</pubDate></item><item><title><![CDATA[R30 - Désactiver les comptes utilisateur inutilisés]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Compte_utilisateurs" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Compte_utilisateurs</a> 
 <br><br>La désactivation des comptes permet de réduire la surface d'attaque par des comptes inutilisés ou obsolète, tout en assurant que les mots de passe des comptes actif soient robustes.<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé:  <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Compte_utilisateurs" class="tag" target="_blank" rel="noopener nofollow">#Compte_utilisateurs</a>
<br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Désactiver les comptes utilisateur inutilisés<br><br>Dans un premier temps, il est nécessaire de trouver les comptes qui ne ce sont jamais connectés ou depuis un certain temps.<br>laslog
<br>1. Désactiver un compte par date<br>Il est possible d'indiquer une date de désactivation pour le compte, une fois cette date dépassé le compte ne sera pas supprimé mais inutilisable.<br>sudo usermod --expiration 1 &lt;nom_utilisateur&gt;
<br>Il est possible de réactiver le compte en :<br>
<br>Modifiant la date d'expiration :
<br>sudo usermod --expiredate &lt;YYYY-MM-DD&gt; &lt;nom_utilisateur&gt;
<br>
<br>Désactivant la date d'expiration :
<br>sudo usermod --expiredate "" &lt;nom_utilisateur&gt;
<br>Vérifier le statut du compte :<br>sudo chage -l &lt;nom_utilisateur&gt;
<br>Cela affichera des informations comme :<br>
<br>Dernier changement de mot de passe.
<br>Date d'expiration du compte (si applicable).
<br>Validité du mot de passe.
<br>2. Verrouiller le compte <br>Les comptes utilisateurs peuvent également être inutilisable sans être supprimé, à l'aide de la commande :<br>sudo usermod -L &lt;nom_utilisateur&gt;
<br>Le compte peut être déverrouillé par :<br>sudo usermod -U &lt;nom_utilisateur&gt;
<br>3. Supprimer un compte<br>Si le compte n'a plus aucune utilisation et ne sera jamais utilisé, il est toujours préférable de supprimer :<br>sudo userdel -r &lt;nom_utilisateur&gt;
<br><br>La différence entre le verrouillage de compte et la désactivation va dépendre des cas d'usage :<br>Désactivation d’un compte :<br>
La désactivation consiste à rendre un compte inutilisable en définissant une date d'expiration passée. Cela empêche l'utilisateur de se connecter sans modifier les fichiers de configuration critiques comme le hash du mot de passe.<br>Le verrouillage d'un compte :<br>
Le verrouillage d’un compte consiste à empêcher l'utilisateur de s'authentifier en modifiant directement le champ de mot de passe dans le fichier /etc/shadow. Cela rend impossible toute connexion par mot de passe.<br>En résumé<br>]]></description><link>wiki\configuration-système\r30-désactiver-les-comptes-utilisateur-inutilisés.html</link><guid isPermaLink="false">Wiki/Configuration système/R30 - Désactiver les comptes utilisateur inutilisés.md</guid><pubDate>Sun, 15 Dec 2024 23:03:13 GMT</pubDate></item><item><title><![CDATA[R31 - Utiliser des mots de passe robustes]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Mot_de_passe" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Mot_de_passe</a> 
 <br><br>L'objectif est de renforcer la sécurité des systèmes Linux en exigeant l'utilisation de mots de passe robustes. Ces mots de passe doivent être complexes, uniques et propres à chaque machine ou utilisateur pour limiter les risques d'accès non autorisé et d'attaques telles que le brute force ou l'usurpation d'identité.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Lynis - Alerte - incidence significative sur la notation
<br>Tag : <a href=".?query=tag:Mot_de_passe" class="tag" target="_blank" rel="noopener nofollow">#Mot_de_passe</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Utiliser des mots de passe robustes<br><br><br>1. Définir des politiques de mots de passe robustes<br>
<br>Modifiez le fichier /etc/security/pwquality.conf pour imposer des règles strictes :
<br>apt install libpam-pwquality libpwquality-tools # installer pwquality

minlen = 12            # Longueur minimale de 12 caractères
dcredit = -1           # Minimum 1 chiffre
ucredit = -1           # Minimum 1 lettre majuscule
lcredit = -1           # Minimum 1 lettre minuscule
ocredit = -1           # Minimum 1 caractère spécial
maxrepeat = 3          # Limite les répétitions de caractères identiques
<br>
<br>Assurez-vous que le module PAM utilise ces règles dans /etc/pam.d/common-password :
<br>password requisite pam_pwquality.so retry=3
<br><br>**2. Configurer l'expiration des mots de passe avec la commande chage :<br>sudo chage -M 90 -m 7 -W 7 &lt;nom_utilisateur&gt;
# -M durée maximale avant changement obligatoire
# -m Nombre minimum de jours avant un changement
# -W Avertissement avant expiration
<br><br>**3. Générer des mots de passe robustes<br>
<br>Utilisez des gestionnaires de mots de passe, tel que KeePass ou Bitwarden pour générer et stocker des mots de passe complexes.
<br>Exemple de génération aléatoire via pwgen :
<br>sudo apt install pwgen
pwgen -s 16 1
<br><br>4. Appliquer des mots de passe par machine<br>
<br>Pour chaque machine, générez un mot de passe unique. Cela limite l'impact d'une compromission.
<br>Stockez les mots de passe dans un fichier sécurisé, par exemple avec chattr :
<br>sudo chattr +i /etc/secure_passwords.txt
<br><br>5. Auditer les mots de passe<br>
<br>Vérifiez la robustesse des mots de passe avec des outils comme john ou hydra (pour les tests internes uniquement).
<br>Listez les comptes sans mot de passe avec :
<br>sudo cat /etc/shadow/ | awk -F: '($2==""){print $1}'
<br><br>L'utilisation de mots de passe robustes et uniques par machine est une mesure essentielle pour sécuriser un système Linux. Combinée à une politique de renouvellement régulier et à l'utilisation d'outils comme pam_pwquality, elle limite les risques liés à des attaques par mot de passe et assure une meilleure sécurité globale.]]></description><link>wiki\configuration-système\r31-utiliser-des-mots-de-passe-robustes.html</link><guid isPermaLink="false">Wiki/Configuration système/R31 - Utiliser des mots de passe robustes.md</guid><pubDate>Sun, 15 Dec 2024 23:03:26 GMT</pubDate></item><item><title><![CDATA[R32 - Expirer les sessions utilisateurs locales]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Session_utilisateur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Session_utilisateur</a> 
 <br><br>L'objectif de cette mesure est de renforcer la sécurité des sessions utilisateur locales (console TTY ou sessions graphiques) en les verrouillant automatiquement après un délai d'inactivité. Cela empêche qu'un accès non autorisé soit obtenu sur une session laissée ouverte.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a>
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Session_utilisateur" class="tag" target="_blank" rel="noopener nofollow">#Session_utilisateur</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Expirer les sessions utilisateurs locales<br>
<a rel="noopener nofollow" class="external-link" href="https://forum-debian.fr/viewtopic.php?t=2542" target="_blank">https://forum-debian.fr/viewtopic.php?t=2542</a><br><br><br>1. Configurer l'expiration des sessions TTY (console)<br>
<br>Ajouter la variable d'environnement TMOUT dans le fichier /etc/profile :
<br>echo "TMOUT=600" | sudo tee -a /etc/profile
<br>
<br>
TMOUT=600 déconnecte automatiquement l'utilisateur après 10 minutes d'inactivité (600 secondes).

<br>
Appliquer globalement la configuration :

<br>sudo echo "export TMOUT=600" &gt;&gt; /etc/bash.bashrc
<br>
<br>
Relancer les sessions pour appliquer les modifications.

<br>
Bloquez la modification de TMOUT par les utilisateurs en ajoutant cette ligne dans /etc/profile :

<br>readonly TMOUT
<br>
<br>Testez la configuration en vous connectant à une console TTY.
<br><br><br> Avantages :<br>
<br>
Protection contre les accès non autorisés : Les sessions inactives ne restent pas ouvertes, réduisant les risques d'exploitation.

<br>
Adaptabilité : Fonctionne aussi bien pour les sessions TTY que pour les environnements graphiques.
Limites :

<br>
Un délai trop court peut frustrer les utilisateurs.

<br>
Les sessions administratives nécessitent parfois une activité prolongée sans interaction.

<br>L'expiration automatique des sessions utilisateur locales est une mesure essentielle pour renforcer la sécurité d'un système Linux. En configurant correctement les sessions TTY et graphiques, vous réduisez les risques liés aux sessions laissées ouvertes tout en respectant les standards de sécurité recommandés.             ]]></description><link>wiki\configuration-système\r32-expirer-les-sessions-utilisateurs-locales.html</link><guid isPermaLink="false">Wiki/Configuration système/R32 - Expirer les sessions utilisateurs locales.md</guid><pubDate>Sun, 15 Dec 2024 23:03:34 GMT</pubDate></item><item><title><![CDATA[R33 - Assurer l’imputabilité des actions d’administration]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Traçabilité" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Traçabilité</a> 
 <br><br>L’objectif est de garantir la traçabilité des actions administratives sur un système Linux, en identifiant clairement les utilisateurs responsables des actions nécessitant des privilèges élevés. Cela permet d’imputer toute activité malveillante ou non autorisée à un administrateur spécifique.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a>
<br>**Lynis - Augmentation de 1 point sur la notation Lynis
<br>Tag : <a href=".?query=tag:Traçabilité" class="tag" target="_blank" rel="noopener nofollow">#Traçabilité</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Assurer l’imputabilité des actions d’administration<br>
<a rel="noopener nofollow" class="external-link" href="https://www.techrepublic.com/article/how-to-create-a-new-user-with-admin-privileges-on-linux/" target="_blank">https://www.techrepublic.com/article/how-to-create-a-new-user-with-admin-privileges-on-linux/</a><br>
<a rel="noopener nofollow" class="external-link" href="https://forum.ubuntu-fr.org/viewtopic.php?id=1576321" target="_blank">https://forum.ubuntu-fr.org/viewtopic.php?id=1576321</a><br><br><br>1. Utiliser des comptes d'administration dédiés et sudo<br>
<br>Créer des comptes nominaux pour chaque administrateur :
<br>
<br>Chaque administrateur doit disposer d'un compte distinct pour accéder au système.
<br>Exemple de création d'un compte administrateur :
<br>sudo useradd -m -s /bin/bash admin_nom
sudo passwd admin_nom
<br>
<br>Désactiver le compte root :
<br>
<br>Verrouillez le compte root pour empêcher tout accès direct :
<br>sudo usermod -L -e 1 root
<br>
<br>Désactivez le shell de connexion pour root
<br>sudo usermod -s /bin/false root
<br>
<br>Configurer sudo pour journaliser les actions :
<br>
<br>Vérifiez que sudo est installé et activé :
<br>sudo apt install sudo
<br>
<br>Ajoutez les administrateurs au groupe sudo :
<br>sudo usermod -aG sudo admin_nom
<br>
<br>Activez la journalisation dans /etc/sudoers :
<br>Defaults logfile="/var/log/sudo.log"
<br><br>2. Journalisation des processus avec auditd<br>
<br>Installer et configurer auditd :
<br>
<br>Installez le démon d'audit :
<br>sudo apt install auditd  # Debian/Ubuntu
<br>
<br>Démarrez et activez le service :
<br>sudo systemctl start auditd
sudo systemctl enable auditd
<br>
<br>Ajouter des règles pour journaliser la création de processus :
<br>
<br>Editez le fichier /etc/audit/rules.d/audit.rules pour inclure les règles suivantes :
<br># Journalisation des processus 64 bits
-a exit,always -F arch=b64 -S execve,execveat
# Journalisation des processus 32 bits
-a exit,always -F arch=b32 -S execve,execveat
<br>
<br>Rechargez la configuration d'audit :
<br>sudo auditctl -R /etc/audit/rules.d/audit.rules
<br>
<br>Vérifier les logs générés :
<br>
<br>Les logs de création de processus sont enregistrés dans /var/log/audit.log
<br>Exemple de recherche d'un évènement :
<br>sudo ausearch -c 'bash'
<br>
<br>Exporter les logs régulièrement :
<br>
<br>Configurez une solution d'export des logs (ex :serveur distant ou outil centralisé comme rsyslog ou logstach).
<br><br>**3. Bonnes pratiques pour une meilleure traçabilité<br>
<br>Identification nominative :
<br>
<br>Utilisez des clés SSH individuelles pour identifier chaque administrateur
<br>Exemple de configuration SSH :
<br>ssh-keygen -t rsa -b 4096
<br>
<br>Ajout de la clé publique dans  /home/admin_nom/.ssh/authorized_keys
<br><br><br>Avantages :<br>
<br>Traçabilité renforcée : Les actions administratives sont attribuées de manière unique et identifiable.
<br>Sécurité accrue : Réduction des risques liés à l’utilisation partagée ou abusive du compte root.
<br>Compliance : Répond aux exigences de nombreuses normes de sécurité (ISO 27001, RGPD).
<br>Limites :<br>
<br>Les logs générés par auditd peuvent être volumineux et nécessitent une solution d’archivage ou de centralisation.
<br>Une mauvaise configuration des comptes ou des permissions peut compromettre l’efficacité de la mesure.
<br>Assurer l’imputabilité des actions d’administration est une mesure clé pour renforcer la sécurité et la responsabilité dans la gestion d’un système Linux. En combinant l’utilisation de comptes nominatifs, sudo, et la journalisation des processus avec auditd, vous obtenez une traçabilité complète et fiable, essentielle pour identifier les administrateurs responsables de chaque action.]]></description><link>wiki\configuration-système\r33-assurer-l’imputabilité-des-actions-d’administration.html</link><guid isPermaLink="false">Wiki/Configuration système/R33 - Assurer l’imputabilité des actions d’administration.md</guid><pubDate>Sun, 15 Dec 2024 23:03:42 GMT</pubDate></item><item><title><![CDATA[R34 - Désactiver les comptes de service]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Comptes_de_services" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Comptes_de_services</a> 
 <br><br>L’objectif de cette mesure est de renforcer la sécurité en désactivant ou en isolant les comptes de service inutiles ou mal configurés. Cela empêche des applications utilisant le même compte (comme nobody) de partager des privilèges, ce qui pourrait engendrer des risques de sécurité comme l’altération des configurations ou des conflits interservices.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a>
<br>**Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Comptes_de_services" class="tag" target="_blank" rel="noopener nofollow">#Comptes_de_services</a> 
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Désactiver les comptes de service<br><br><br>1. Identifier les comptes de service existants`<br>
<br>Lister tous les comptes système :
<br>
<br>Utilisez la commande awk pour afficher tous les comptes avec UID inférieur à 1000 (souvent réservé aux comptes système) :
<br>awk -F: '($3 &lt; 1000) {print $1}' /etc/passwd
<br>
<br>Vérifier l'utilisation des comptes de service :
<br>
<br>Repérez les comptes non nécessaires ou partagés (comme nobody) en identifiant leurs processus associés :
<br>ps -u nobody
<br><br>2. Désactiver ou isoler un compte de service`<br>
<br>Désactiver un compte de service :
<br>
<br>Verrouillez un compte pour empêcher tout accès ou exécution :
<br>sudo usermod -L -e 1 &lt;nom_du_compte&gt;
<br>
<br>-L : Verrouille le compte
<br>-e 1 : Définit une date d'expiration déjà passée.
<br>
<br>Désactiver le shell de connexion :
<br>
<br>Modifiez le shell par défaut pour l'interaction directe :
<br>sudo usermod -s /usr/sbin/nologin &lt;nom_du_compte&gt;
<br>
<br>Créer des comptes dédiés pour les services partageant nobody :
<br>
<br>Si plusieurs services utilisent le compte nobody, créez des comptes distincts pour chacun d’eux 
<br>sudo useradd -r -s /usr/sbin/nologin &lt;nom_service&gt;
<br>
<br>-r : Crée un compte système
<br>-s : Définit un shell non interactif
<br><br><br>Avantages :<br>
<br>Isolation renforcée : Chaque service est isolé, limitant les interférences entre eux.
<br>Réduction des surfaces d’attaque : Les comptes inutiles ou partagés ne peuvent plus être exploités.
<br>Conformité : Répond aux exigences des normes de sécurité pour la gestion des comptes.
<br>Limites :<br>
<br>La création de comptes dédiés peut alourdir la gestion des permissions et des configurations.
<br>Nécessite une vérification rigoureuse pour éviter des erreurs dans les services critiques.
<br>Désactiver les comptes de service inutiles ou partagés est une étape cruciale pour sécuriser un système Linux. En combinant la désactivation des comptes inutilisés, la création de comptes dédiés et l’isolation des permissions, vous minimisez les risques de conflits interservices et renforcez la sécurité globale du système.]]></description><link>wiki\configuration-système\r34-désactiver-les-comptes-de-service.html</link><guid isPermaLink="false">Wiki/Configuration système/R34 - Désactiver les comptes de service.md</guid><pubDate>Sun, 15 Dec 2024 23:03:51 GMT</pubDate></item><item><title><![CDATA[R35 - Utiliser des comptes de service uniques et exclusifs]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Comptes_de_services" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Comptes_de_services</a> 
 <br><br>L’objectif est de garantir l’isolation des privilèges pour chaque service métier (comme nginx, php, ou mysql) en leur attribuant des comptes système uniques et exclusifs. Cette mesure permet d’éviter qu’un service compromise puisse affecter les autres ou accéder à leurs ressources.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a>
<br>**Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Comptes_de_services" class="tag" target="_blank" rel="noopener nofollow">#Comptes_de_services</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Utiliser des comptes de service uniques et exclusifs<br><br><br>1. Identifier les services métier sur le système<br>
<br>Lister tous les services installés :
<br>systemctl list-units --type=service
<br>
<br>Repérer les services partageant un compte :
<br>
<br>Analysez les processus pour vérifier quels services utilisent un compte partagé, comme nobody 
<br>ps aux | grep nobody
<br><br>2. Créer des comptes uniques pour chaque service<br>
<br>Créer un compte dédié pour un service :
<br>
<br>Exemple pour un service comme nginx :
<br>sudo useradd -r -s /usr/sbin/nologin -d /var/www nginx
<br>
<br>-r : Crée un compte système.
<br>-s /usr/sbin/nologin : Empêche l'accès direct via un shell interactif.
<br>-d : Spécifie le répertoire de travail.
<br>
<br>Vérifier les utilisateurs associés aux services :
<br>
<br>Par exemple, pour nginx :
<br>sudo grep "User" /etc/nginx/nginx.conf
<br>
<br>Redémarrer le service :
<br>
<br>Après modification, redémarrez le service pour appliquer les changement
<br>sudo systemctl restart nginx
<br>
<br>-r : Crée un compte système
<br>-s : Définit un shell non interactif
<br><br>3. Configurer les permissions des fichiers et répertoires<br>
<br>Assigner les fichiers et répertoires au compte dédié :
<br>
<br>Pour le service nginx
<br>sudo chown -R nginx:nginx /var/www
<br>
<br>Limiter les permissions :
<br>
<br>Appliquez des permissions minimales pour garantir l'isolation :
<br>chmod -R 750 /var/www
<br><br>Avantages :<br>
<br>Isolation renforcée : Empêche qu’un service compromis puisse affecter un autre service.
<br>Sécurité accrue : Réduit les risques d’exploitation via des comptes partagés.
<br>Facilité d’audit : Les comptes dédiés simplifient l’analyse des logs et la traçabilité.
<br>Limites :<br>
<br>L’ajout de comptes dédiés nécessite une gestion rigoureuse des permissions.
<br>Une mauvaise configuration des services ou des permissions peut entraîner des dysfonctionnements.
<br>L’utilisation de comptes de service uniques et exclusifs est une pratique essentielle pour sécuriser un système Linux. En attribuant des comptes dédiés à chaque service métier, vous renforcez l’isolation des privilèges et minimisez les risques d’interférence ou d’exploitation entre services. Cette mesure améliore à la fois la sécurité et la traçabilité des actions sur le système.]]></description><link>wiki\configuration-système\r35-utiliser-des-comptes-de-service-uniques-et-exclusifs.html</link><guid isPermaLink="false">Wiki/Configuration système/R35 - Utiliser des comptes de service uniques et exclusifs.md</guid><pubDate>Sun, 15 Dec 2024 23:04:00 GMT</pubDate></item><item><title><![CDATA[R39 - Modifier les directives de configuration `sudo`]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Sudo" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sudo</a> 
 <br><br>L’objectif est de renforcer la sécurité de l'utilisation de sudo en configurant des directives par défaut strictes dans le fichier /etc/sudoers. Cela limite les risques d’escalade de privilèges, empêche l’exécution de commandes non sécurisées, et restreint les modifications non autorisées dans l’environnement d’un utilisateur.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a>
<br>**Lynis - Aucune incidence sur la notation lynis
<br>Tags:  <a href=".?query=tag:Sudo" class="tag" target="_blank" rel="noopener nofollow">#Sudo</a> 
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Modifier les directives de configuration sudo<br><br><br>1. Modifier le fichier /etc/sudoers<br>
<br>Editer le fichier sudoers :
<br>
<br>Utilisez une commande sécurisée pour éditer le fichier
<br>sudo visudo
<br>
<br>Ajouter les directives suivantes dans le fichier :
<br>Defaults noexec            # Empêche l'exécution de nouveaux programmes dans les commandes appelées
Defaults requiretty        # Nécessite un TTY pour exécuter sudo (pas de scripts non interactifs)
Defaults use_pty           # Force l'utilisation de pseudo-TTY pour les actions sudo
Defaults umask=0077        # Applique un masque restrictif pour les permissions
Defaults ignore_dot        # Ignore le « . » dans $PATH (empêche l'exécution de commandes locales non sécurisées)
Defaults env_reset         # Réinitialise les variables d’environnement pour éviter les fuites ou injections
<br>
<br>Exemple de configuration complète :
<br>Defaults noexec,requiretty,use_pty,umask=0077,ignore_dot,env_reset

# Définition des permissions pour un utilisateur spécifique (optionnel)
myuser ALL = EXEC: /usr/bin/mycommand

# Autoriser un groupe administratif à désactiver temporairement une directive (optionnel)
Defaults:%admins !noexec
<br><br>2. Test de la configuration<br>
<br>Vérifier les directives appliquées :
<br>
<br>Affichez les paramètres par défaut de sudo :
<br>sudo -V | grep Defaults
<br>
<br>Tester le comportement des directives :
<br>
<br>noexec : Testez qu'aucun programme externe ne peut être exécuté depuis une commande sudo :
<br>sudo less /etc/passwd
!ls   # La commande `ls` ne doit pas s’exécuter
<br>
<br>requiretty : Vérifiez que les scripts non interactifs échouent sans TTY :
<br>echo "sudo ls" | at now
<br>
<br>
use_pty : Confirmez que toutes les commandes sudo passent par un pseudo-TTY

<br>
Vérifiez les logs pour les actions sudo

<br>sudo journalctl -xe
<br>
<br>umask=0077 : Assurez-vous que les fichiers créés avec sudo ont des permissions restrictives :
<br>sudo touch testfile
ls -l testfile  # Les permissions doivent être `-rwx------`
<br><br>3. Ajouter des règles spécifiques pour les utilisateurs et groupes<br>
<br>Définir des commandes spécifiques pour un utilisateur :
<br>
<br>Ajoutez une règle pour autoriser un utilisateur à exécuter uniquement une commande donnée :
<br>myuser ALL = EXEC: /usr/bin/mycommand
<br>
<br>Autoriser un groupe administratif à désactiver une directive :
<br>
<br>Par exemple, désactiver temporairement noexec pour un groupe :
<br>Defaults:%admins !noexec
<br>
<br>Limiter les commandes autorisées pour un utilisateur :
<br>
<br>Exemple :
<br>myuser ALL=(ALL) /usr/bin/systemctl restart nginx
<br><br> Avantages :<br>
<br>
Renforce la sécurité : Les directives noexec, requiretty, et use_pty empêchent les contournements de privilèges via des scripts ou shells intéractifs.

<br>
Réduction des risques : Les réglages comme ignore_dot et env_reset réduisent les risques d’exploits via des variables d’environnement ou des chemins malveillants.

<br>
Flexibilité : La configuration peut être ajustée pour des utilisateurs ou groupes spécifiques.
Limites :

<br>
Incompatibilité potentielle : Certaines applications ou scripts nécessitant des environnements particuliers peuvent échouer (ex. scripts sans TTY).

<br>
Gestion accrue : Les règles spécifiques pour utilisateurs ou groupes complexes nécessitent une documentation claire.

<br>La configuration stricte de sudo via les directives recommandées permet de sécuriser l’exécution des commandes nécessitant des privilèges élevés. En imposant des restrictions comme noexec, requiretty, et use_pty, vous limitez les risques d’escalade de privilèges ou d’exécutions non autorisées. Cette mesure renforce considérablement la sécurité et la traçabilité des actions administratives sur le système.]]></description><link>wiki\configuration-système\r39-modifier-les-directives-de-configuration-`sudo`.html</link><guid isPermaLink="false">Wiki/Configuration système/R39 - Modifier les directives de configuration `sudo`.md</guid><pubDate>Sun, 15 Dec 2024 23:04:08 GMT</pubDate></item><item><title><![CDATA[R40 - Utiliser des utilisateurs cibles non-privilégiés pour les commandes SUDO]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Sudo" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sudo</a> 
 <br><br>L’objectif est de limiter les risques d’escalade de privilèges et de contournement des politiques de sécurité en configurant sudo pour qu’il utilise, autant que possible, des utilisateurs cibles non-privilégiés (non root). Cela réduit l’impact potentiel des commandes fonctionnellement riches (comme vi) en minimisant les privilèges accordés.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a>
<br>**Lynis - Ne peut pas être testé
<br>Tags:  <a href=".?query=tag:Sudo" class="tag" target="_blank" rel="noopener nofollow">#Sudo</a> 
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Modifier les directives de configuration sudo<br><br><br>1. Comprendre les utilisateurs cibles et leurs privilèges<br>
<br>Utilisateur cible dans sudo :
<br>
<br>Dans une règle sudo, l'utilisateur cible désigne l'utilisateur pour lequel la commande sera exécutée.
<br>Exemple : dans la règle suivante :
<br>myuser ALL=(root) /usr/bin/systemctl restart nginx
<br>
<br>
root est l'utilisateur cible.

<br>
Pour réduire les risques, remplacez autant que possible root par un utilisateur non-privilégié.

<br>
<br>Pourquoi éviter les utilisateurs privilégiés comme cible 
<br>
<br>Les commandes riches (ex : éditeurs de texte, interpréteurs) permettent de lancer des sous-processus avec les privilèges de l'utilisateur cible, ce qui conduire à une escalade de privilèges.
<br><br><br>Avantages :<br>
<br>Réduction des risques : En utilisant des utilisateurs cibles non-privilégiés, vous limitez les conséquences d’un contournement ou d’une exploitation.
<br>Isolation renforcée : Les tâches spécifiques sont exécutées avec les privilèges minimum nécessaires, réduisant les impacts sur d’autres parties du système.
<br>Traçabilité accrue : Les actions sont clairement attribuées à des utilisateurs spécifiques, et non à root.
<br>Limites :<br>
<br>Certaines commandes nécessitent impérativement root comme utilisateur cible, ce qui peut limiter l’application de cette mesure.
<br>Les protections comme noexec ne sont pas infaillibles et peuvent être contournées par des appels système (execve).
<br>L’utilisation d’utilisateurs cibles non-privilégiés pour les commandes sudo est une mesure essentielle pour renforcer la sécurité et minimiser les risques d’escalade de privilèges. En limitant les privilèges des commandes et en combinant cette approche avec des protections comme noexec et use_pty, vous garantissez un environnement plus sécurisé et mieux contrôlé.]]></description><link>wiki\configuration-système\r40-utiliser-des-utilisateurs-cibles-non-privilégiés-pour-les-commandes-sudo.html</link><guid isPermaLink="false">Wiki/Configuration système/R40 - Utiliser des utilisateurs cibles non-privilégiés pour les commandes SUDO.md</guid><pubDate>Sun, 15 Dec 2024 23:04:16 GMT</pubDate></item><item><title><![CDATA[R42 - Bannir les négations dans les spécifications sudo]]></title><description><![CDATA[<a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Sudo" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sudo</a> 
 <br><br>L’objectif de cette mesure est d’éliminer l’utilisation de négations (!) dans les spécifications de commandes dans les règles sudo. Les négations peuvent créer des ambiguïtés dans l’évaluation des droits et ouvrir des possibilités de contournement ou de détournement des politiques de sécurité<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a>
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tags:  <a href=".?query=tag:Sudo" class="tag" target="_blank" rel="noopener nofollow">#Sudo</a> 
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Bannir les négations dans les spécifications sudo<br>
<a rel="noopener nofollow" class="external-link" href="https://www.it-connect.fr/commande-sudo-comment-configurer-sudoers-sous-linux/" target="_blank">https://www.it-connect.fr/commande-sudo-comment-configurer-sudoers-sous-linux/</a><br><br><br>1. Comprendre le problème des négations dans sudo<br>
<br>Principe de la négation dans sudo :
<br>
<br>Les règles sudo permettant d'interdire certaines commandes commandes en utilisant une syntaxe avec !. Exemple :
<br>admin ALL = ALL, !/usr/bin/vi
<br>
<br>Ici, l'utilisateur admin peut exécuter toutes les commandes sauf /usr/bin/vi.
<br>
<br>Problème de sécurité :
<br>
<br>Ambiguité : Les négations introduisent des comportements imprévisibles dans la comparaison des chaînes, surtout lorsque les arguments des commandes ou des chemins complexes sont impliqués.
<br>Exemple de Contournement :

<br>Si vi est interdit mais qu'une commande aliasée ou un script indirect accède à vi, la règle peut être contournée.


<br><br>**2. Eviter les négociations dans le fichier sudoers<br>
<br>Supprimer les règles avec des négations :
<br>
<br>Ouvrer le fichier de configuration sudo /etc/sudoersavec une commande sécurisée :
<br>sudo visudo
<br>
<br>Recherchez et supprimer toutes les règles contenant !. Exemple :
<br>Defaults:admin !/usr/bin/vi
<br>
<br>Créer des règles spécifiques sans négation :
<br>
<br>Remplacez les règles ambiguës par des règles explicites limitant les commandes autorisées.
<br>Exemple :
<br>admin ALL = /usr/bin/systemctl restart nginx, /usr/bin/systemctl start nginx
<br>
<br>Ici, admin est autorisé uniquement à exécuter deux commandes spécifiques.
<br><br>3. Ajouter des alias pour simplifier la configuration<br>
<br>Définir des alias pour des groupes de commandes autorisées :
<br>
<br>Ajoutez des allias pour regrouper les commandes autorisées dans le fichier sudoers :
<br>Cmnd_Alias NGINX_COMMANDS = /usr/bin/systemctl restart nginx, /usr/bin/systemctl status nginx
admin ALL = NGINX_COMMANDS
<br>
<br>Vérifier les permissions :
<br>
<br>Pour tester les commandes disponibles pour un utilisateur :
<br>sudo -l -U admin
<br><br>4. Tester et valider la configuration<br>
<br>Simuler les commandes autorisées et interdites :
<br>
<br>
Connectez vous en tant que qu'utilisateur et testez les commandes autorisées dans le contexte défini.

<br>
Exemple :

<br>sudo /usr/bin/systemctl restart nginx
sudo /usr/bin/vi
<br>
<br>Utiliser une analyse statique des configurations sudoers :
<br>
<br>
Utilisez des outils comme visudo ou de scripts personnalisés pour détecter les règles contenant des négations.

<br>
Exemple de recherche rapide dans sudoers :

<br>grep "!" /etc/sudoers /etc/sudoers.d/*
<br><br><br>Avantages :<br>
<br>Clarté et lisibilité : L’élimination des négations rend les règles plus lisibles et plus prévisibles.
<br>Réduction des risques : Empêche les contournements dus à des chemins ou arguments mal interprétés.
<br>Conformité : Respecte les bonnes pratiques recommandées pour la gestion des privilèges.
<br>Limites :<br>
<br>Nécessite une gestion rigoureuse et détaillée des règles dans le fichier sudoers.
<br>Peut complexifier la configuration si un grand nombre de commandes doivent être explicitement listées.
<br>Bannir les négations dans les spécifications sudo est une étape essentielle pour améliorer la sécurité et la robustesse des politiques de gestion des privilèges. En combinant cette mesure avec une configuration claire et précise des commandes autorisées, vous réduisez significativement les risques de contournement ou d’escalade de privilèges sur votre système Linux.]]></description><link>wiki\configuration-système\r42-bannir-les-négations-dans-les-spécifications-sudo.html</link><guid isPermaLink="false">Wiki/Configuration système/R42 - Bannir les négations dans les spécifications sudo.md</guid><pubDate>Sun, 15 Dec 2024 23:04:27 GMT</pubDate></item><item><title><![CDATA[R53 - Eviter les fichiers ou répertoires sans utilisateur ou sans groupe connu]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Gestion_des_droits" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Gestion_des_droits</a> 
 <br><br>L’objectif de cette mesure est d’assurer que tous les fichiers et répertoires du système appartiennent à des utilisateurs ou des groupes connus. Cela prévient les risques d’exploitation liés à des fichiers abandonnés ou mal configurés, qui pourraient servir à des escalades de privilèges ou des actions malveillantes.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a>
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Gestion_des_droits" class="tag" target="_blank" rel="noopener nofollow">#Gestion_des_droits</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Eviter les fichiers ou répertoires sans utilisateur ou sans groupe connu<br><br><br>**1. Identifier les fichiers et répertoires problématiques<br>
<br>Lister tous les fichiers ou répertoires sans propriétaire ou groupe connu :
<br>sudo find / -type f \( -nouser -o -nogroup \) -ls 2&gt;/dev/null
<br>
<br>-nouser : Fichiers sans utilisateur associé.
<br>nogroup : Fichiers sans groupe associé.
<br>-ls : Affiche des informations sur les fichiers identifiés.
<br><br>**2. Analyser les résultats<br>
<br>Identifier les fichiers critiques pour déterminer leur utilisation et leur ancien propriétaire.
<br>Exemple de sortie de la commande find :
<br>123456 4 -rw-r--r-- 1 1001 1001 4096 Dec 6 10:00 /path/to/file
<br><br>**3. Corriger les fichiers sans utilisateur ou groupe<br>
<br>Attribuer un utilisateur et un groupe légitimes aux fichiers concernés :
<br>sudo chown root:root /path/to/file
<br>
<br>root:root peut être remplacé par un utilisateur ou groupe spécifique selon les besoins.
<br><br>**4. Restreindre les permissions d'écriture sur les répertoires accessibles à tous<br>
<br>Identifier les répertoires accessibles en écriture par tous :
<br>sudo find / -type d -perm -0002 -ls 2&gt;/dev/null
<br>
<br>Cela détecte les répertoires avec des permissions comme 777 (écriture autorisée pour tous).
<br><br><br>**1. Lister les fichiers problématiques :<br>sudo find / -type f \( -nouser -o -nogroup \) -ls 2&gt;/dev/null
<br>**2. Attribuer un propriétaire légitime :<br>sudo chown root:root /unfamiliar/file
<br>**3. Restreindre les répertoires publics :<br>
<br>Exemple pour /tmp :
<br>sudo chmod +t /tmp
<br><br><br>Éviter les fichiers ou répertoires sans utilisateur ou groupe connu est une mesure clé pour garantir l’intégrité et la sécurité d’un système Linux. En effet, les fichiers sans propriétaire peuvent être exploités par des utilisateurs malveillants pour compromettre le système. Une bonne cohérence dans les permissions permet de faciliter la gestion des fichiers. Combinée à l’activation du sticky bit sur les répertoires accessibles en écriture, elle réduit les risques d’abus et d’escalade de privilèges tout en assurant un système mieux organisé et plus sécurisé.]]></description><link>wiki\configuration-système\r53-eviter-les-fichiers-ou-répertoires-sans-utilisateur-ou-sans-groupe-connu.html</link><guid isPermaLink="false">Wiki/Configuration système/R53 - Eviter les fichiers ou répertoires sans utilisateur ou sans groupe connu.md</guid><pubDate>Sun, 15 Dec 2024 23:04:34 GMT</pubDate></item><item><title><![CDATA[R54 - Activer le Sticky Bit sur les répertoires Inscriptibles]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Sticky_bit" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sticky_bit</a> 
 <br><br>L’objectif de cette mesure est de protéger les fichiers situés dans des répertoires accessibles en écriture par tous. L'activation du sticky bit empêche quiconque (autre que le propriétaire du fichier ou l'administrateur) de supprimer ou modifier un fichier, même si le répertoire est inscriptible par tous.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a> 
<br>Lynis - Augmentation de 1 points sur la notation
<br>Tag: <a href=".?query=tag:Sticky_bit" class="tag" target="_blank" rel="noopener nofollow">#Sticky_bit</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Eviter les fichiers ou répertoires sans utilisateur ou sans groupe connu<br><br><br>**1. Identifier les répertoires concernés<br>
<br>Utilisez la commande suivante pour détecter ces répertoires :
<br>sudo find / -type d \( -perm -0002 -a \! -perm -1000 \) -ls 2&gt;/dev/null
<br>
<br>
-perm -0002 : Recherche les répertoires accessibles en écriture par tous.

<br>
\! -perm -1000 : Exclut les répertoires avec le sticky bit activé.

<br>
-ls : Affiche des informations détaillées des répertoires trouvés.

<br>
Détectez les répertoires où le propriétaire n'est pas root :

<br>sudo find / -type d -perm -0002 -a \! -uid 0 -ls 2&gt;/dev/null
<br>
<br>\! -uid 0 : Exclut les répertoires appartenant à root.
<br><br>**2. Appliquer le sticky bit<br>
<br>Modifiez les permissions pour activer sticky bit :
<br>sudo chmod +t /path/to/directory
<br>
<br>Si plusieurs répertoires sont identifiés, vous pouvez appliquer le sticky bit en boucle :
<br>sudo find / -type d \( -perm -0002 -a \! -perm -1000 \) -exec chmod +t {} \;
<br>
<br>Changez le propriétaire des répertoires concernés si ce n'est pas root :
<br>sudo chown root:root /path/to/directory
<br><br>**3. Automatiser la surveillance des répertoires<br>
<br>Créer un script pour identifier les répertoires à sécuriser :
<br>#!/bin/bash
echo "Vérification des répertoires sans sticky bit :"
find / -type d \( -perm -0002 -a \! -perm -1000 \) -ls 2&gt;/dev/null

echo "Vérification des répertoires inscriptibles dont le propriétaire n'est pas root :"
find / -type d -perm -0002 -a \! -uid 0 -ls 2&gt;/dev/null
<br>
<br>Planifier un audit périodique avec cron :
<br>sudo crontab -e
<br>
<br>Exemple de tâche cron exécutée chaque semaine :
<br>0 0 * * 7 /path/to/stickybit_audit.sh
<br><br>**4. Vérifier que le sticky bit est bien activé sur les répertoires<br>
<br>Vérifiez les répertoires sécurisés :
<br>sudo find / -type d -perm -1000 -ls 2&gt;/dev/null
<br>
<br>Assurez-vous que tous les répertoires partagés sont bien configurés :
<br>ls -ld /path/to/directory
<br><br><br> Avantages :<br>
<br>Prévention des abus : Empêche les utilisateurs de supprimer ou de modifier les fichiers d'autres utilisateurs dans les répertoires partagés.
<br>Simplicité : La mise en œuvre du sticky bit est facile et rapide.
<br>Compatibilité : Compatible avec la plupart des systèmes et applications Linux.
<br>Limites :<br>
<br>Le sticky bit ne protège pas contre des conflits entre deux processus exécutés sous le même utilisateur.
<br>Nécessite une surveillance continue pour détecter les nouveaux répertoires partagés mal configurés.
<br>Activer le sticky bit sur les répertoires inscriptibles est une mesure de sécurité essentielle pour protéger les fichiers dans des environnements partagés. En l’associant à une bonne gestion des permissions et des propriétaires, elle réduit significativement les risques de suppressions ou modifications non autorisées tout en maintenant la disponibilité et l'intégrité des fichiers.                  ]]></description><link>wiki\configuration-système\r54-activer-le-sticky-bit-sur-les-répertoires-inscriptibles.html</link><guid isPermaLink="false">Wiki/Configuration système/R54 - Activer le Sticky Bit sur les répertoires Inscriptibles.md</guid><pubDate>Sun, 15 Dec 2024 23:07:29 GMT</pubDate></item><item><title><![CDATA[R56 - Eviter l'usage d'exécutablex avec les droits spéciaux setuid et setgrid]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:setuid_et_setgrid" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#setuid_et_setgrid</a> 
 <br><br>L'objectif de cette mesure est de limiter les risques associés aux exécutables avec des droits spéciaux (setuid et setgid). Ces droits permettent à un programme de s'exécuter avec les privilèges d'un autre utilisateur (souvent root), ce qui peut introduire des vulnérabilités graves en cas de mauvaise configuration ou d'exploitation d'une faille.<br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a> 
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:setuid_et_setgrid" class="tag" target="_blank" rel="noopener nofollow">#setuid_et_setgrid</a>
<br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Eviter l'usage d'exécutable avec les droits spéciaux setuid et setgrid<br><br>Voici les étapes pour identifier, analyser et limiter l'usage d'exécutable avec des droits spéciaux :<br>1. Identifier les exécutables avec setuid et setgit<br>find / -type f -perm /6000 -ls 2&gt;/dev/null
<br>
<br>6000 cible les permissions spéciales setuid (4) et setgid (2).
<br>La commande renvoie une liste de fichiers concernés.
<br>2. Vérifier les permissions et l'utilité des binaires<br>
<br>Examinez la liste pour identifier les exécutables critiques (souvent liés au système) et ceux inutiles ou suspects.
<br>Exemple de binaires courants nécessitant setuid ou setgid :

<br>/bin/ping
<br>/usr/bin/sudo
<br>/usr/bin/passwd


<br>Vérifier leur source avec :
<br>dpkg -S &lt;fichier&gt;
<br>3. Désactiver les droits setuid ou setgid pour les fichiers inutiles<br>
<br>Supprimez les permissions si elles ne sont pas nécessaires :
<br>chmod u-s &lt;fichier&gt; # Retire le droit `setuid`
chmod g-s &lt;fichier&gt; # Retire le droit `setgid`
<br>
<br>Exemple : retirer setuid d'un fichier suspect :
<br>chmod u-s /path/to/supect_binary
<br><br>La gestion des droits spéciaux setuid et setgid est essentielle pour sécuriser un système Linux. Cette mesure contribue à limiter les risques liés à l'escalade de privilèges et aux binaires mal configurés. En combinant un audit régulier avec des alternatives modernes comme capabilities, il est possible de renforcer significativement la sécurité globale du système. Toute fois, une mauvaise suppression des permissions peut entraîner des dysfonctionnements (exemple : /usr/bin/passwd nécessite setuidpour modifier un mot de passe utilisateur).]]></description><link>wiki\configuration-système\r56-eviter-l&apos;usage-d&apos;exécutablex-avec-les-droits-spéciaux-setuid-et-setgrid.html</link><guid isPermaLink="false">Wiki/Configuration système/R56 - Eviter l&apos;usage d&apos;exécutablex avec les droits spéciaux setuid et setgrid.md</guid><pubDate>Sun, 15 Dec 2024 23:05:17 GMT</pubDate></item><item><title><![CDATA[R58 - N'installer que les paquets strictement nécessaires]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Configuration_des_paquets" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_paquets</a> 
 <br><br>L’objectif de cette mesure est de limiter les vulnérabilités et d'optimiser la sécurité en réduisant la surface d’attaque d’un système Linux. Installer uniquement les paquets nécessaires diminue les risques liés à des logiciels inutilisés, les dépendances inutiles, et les failles potentielles dans des composants superflus.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a> 
<br>Lynis - Ne peut pas être évalué
<br>Tag : <a href=".?query=tag:Configuration_des_paquets" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_paquets</a> 
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; N'installer que les paquets strictement nécessaires<br><br><br>1. Choisir une installation minimaliste dès le départ<br>
<br>Lors de l'installation du système, privilégiez une installation minimile en désactivant les groupes de paquets présélectionnés :

<br>Pendant l'installation, décochez toutes les options comme "Environnement de bureau" s'il ne vous ai pas utile.
<br>Il sera toujours préférable d'installer les paquets un à un, que d'installer plusieurs paquets sans utilité. N'installé que les paquets en fonction de votre besoin.

<br>Exemple pour un serveur sans interface graphique :




<br>sudo apt install openssh-server fail2ban
<br><br>2. Identifier les paquets installés et superflus<br>
<br>Lister tous les paquets actuellement installés :
<br>dpkg --get-selections
<br>
<br>Repérer les paquets installés mais inutilisés :
<br>sudo apt autoremove ---dry-run
<br><br>3. Supprimer les paquets inutiles<br>
<br>Désinstaller les paquets superflus ou non nécessaires :
<br>sudo apt remove &lt;nom_du_paquet&gt;
<br>
<br>Exécuter une commande d'autonettoyage pour supprimer les dépendances inutiles :
<br>sudo apt autoremove
sudo apt autoclean
<br><br>N’installer que les paquets strictement nécessaires est une mesure essentielle pour sécuriser et optimiser un système Linux. En adoptant une approche minimaliste dès l’installation et lors de l'ajout ne nouveaux paquets, vous serez totalement maître de vos paquets, vous pourrez plus facilement anticiper de futurs attaques lors de nouvelle vulnérabilités. Utiliser des outils comme Ansible pour gérer des installations standardisées est une bonne habitude à prendre.<br> Avantages :<br>
<br>
Réduction des risques de sécurité : Les paquets inutiles peuvent contenir des vulnérabilités exploitées par des attaquants.

<br>
Performances améliorées : Un système minimaliste consomme moins de ressources.

<br>
Simplicité de gestion : Moins de logiciels à maintenir et surveiller.
Limites :

<br>
Une approche trop minimaliste peut rendre le système incomplet pour certains cas d’usage.

<br>
Les dépendances complexes peuvent entraîner des suppressions involontaires.

]]></description><link>wiki\configuration-système\r58-n&apos;installer-que-les-paquets-strictement-nécessaires.html</link><guid isPermaLink="false">Wiki/Configuration système/R58 - N&apos;installer que les paquets strictement nécessaires.md</guid><pubDate>Sun, 15 Dec 2024 23:05:27 GMT</pubDate></item><item><title><![CDATA[R59 - Utiliser des dépôts de paquets de confiance]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Veille_et_maintenance" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Veille_et_maintenance</a> <a class="tag" href="?query=tag:Configuration_des_paquets" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_paquets</a> 
 <br><br>L'objectif de cette mesure est de garantir que les paquets logiciels installés ou mis à jour sur un système proviennent de sources sûres et fiables. Cela réduit le risque d'installation de logiciels malveillants ou compromis et assure que les mises à jour appliquées respectent les standards de sécurité et de stabilité.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Veille_et_maintenance" class="tag" target="_blank" rel="noopener nofollow">#Veille_et_maintenance</a> 
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Configuration_des_paquets" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_paquets</a> 
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Utiliser des dépôts de paquets de confiance<br><br><br>Lors de l'installation d'un système d'exploitation Debian, les dépôts sont uniquement de confiance. Ils seront modifiés à 2 conditions :<br>
<br>Si l'utilisateur l'a fais
<br>Si la machine est compromise
<br>1. Vérifier les dépôts<br>Vérifier les dépôts configurés :<br>cat /etc/apt/sources.list
<br>Vous devriez trouver : <br>#deb cdrom: [Debian GNU/Linux 12.8.0 Bookworm_ - Official amd64 NETINST with firmware 20241109-11:04]/ bookworm contrib main non-free-firmware

deb http://deb.debian.org/debian/ bookworm main non-free-firmware
deb-src http://deb.debian.org/debian/ bookworm main non-free-firmware

deb http://security.debian.org/debian-security bookworm-security main non-free-firmware
deb-src http://security.debian.org/debian-security bookworm-security main non-free-firmware

# bookworm-updates, to get updates before a point release is made;
# see https://www.debian.org/doc/manuals/debian-reference/ch02.en.html#_updates_and_backports
deb http://deb.debian.org/debian/ bookworm-updates main non-free-firmware
deb-src http://deb.debian.org/debian/ bookworm-updates main non-free-firmware

# This system was installed using small removable media
# (e.g. netinst, live or single CD). The matching "deb cdrom"
# entries were disabled at the end of the installation process.
# For information about how to configure apt package sources,
# see the sources. list (5) manual
<br>Si des dépôts semblent être malicieux, il possible de les vérifier URL par des analyseurs, tel que : <br>
<br>virustotal (<a rel="noopener nofollow" class="external-link" href="https://www.virustotal.com/gui/home/url" target="_blank">https://www.virustotal.com/gui/home/url</a>)
<br>l'API de google (<a rel="noopener nofollow" class="external-link" href="https://safebrowsing.google.com/" target="_blank">https://safebrowsing.google.com/</a>)
<br>Des outils natif linux existent permettent l'analyse des dépôts, c'est le cas de :<br>
<br>Debsecan
<br><br>2. Supprimer/désactiver les dépôts non approuvés<br>sudo nano /etc/apt/sources.list
# Supprimez les lignes non conformes
<br><br><br>
<br>L'utilisation de dépôts de paquets non approuvés expose le système à des risques de sécurité , tels que l'utilisation de logiciels malveillants ou compromis.
<br>Dans certain cas, des applications spécifiques peuvent nécessiter des dépôts tiers (par exemple, logiciels propriétaires). Ces dépôts doivent être évalués avant leur ajout.
<br>Utiliser des outils comme apt-cacher-ng ou des miroirs internes pour centraliser les mises à jour dans une organisation.
<br>Surveiller les logs pour détecter toute tentative de connexion à un dépôt non approuvé.
]]></description><link>wiki\configuration-système\r59-utiliser-des-dépôts-de-paquets-de-confiance.html</link><guid isPermaLink="false">Wiki/Configuration système/R59 - Utiliser des dépôts de paquets de confiance.md</guid><pubDate>Sun, 15 Dec 2024 23:05:34 GMT</pubDate></item><item><title><![CDATA[R61 - Effectuer des mises à jour régulières]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:Veille_et_maintenance" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Veille_et_maintenance</a> <a class="tag" href="?query=tag:Mise_à_jour" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Mise_à_jour</a> 
 <br><br>L'objectif de cette mesure est de maintenir la sécurité des systèmes Linux en appliquant rapidement les correctifs de sécurité et mises à jour des logiciels installés. Les mises à jour régulières réduisent les risques d'exploitation de vulnérabilités connues dans les composants du système.<br><br><br>
<br>Niveau ANSSI: <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a>
<br>Principe associé: <a href=".?query=tag:Veille_et_maintenance" class="tag" target="_blank" rel="noopener nofollow">#Veille_et_maintenance</a>
<br>Lynis - Aucune incidence sur la notation lynis
<br>Tag : <a href=".?query=tag:Mise_à_jour" class="tag" target="_blank" rel="noopener nofollow">#Mise_à_jour</a>
<br><br><br><a rel="noopener nofollow" class="external-link" href="https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux" target="_blank">https://cyber.gouv.fr/publications/recommandations-de-securite-relatives-un-systeme-gnulinux</a> -&gt; Effectuer des mises à jour régulières<br><br><br>**1. Configurer une politique de mise à jour régulière<br>
<br>Les mises à jour de sécurité doivent être appliquées dès leur disponibilité.
<br>Etablissez une fréquence (ex. hebdomadaire pour les mises à jour non critiques, immédiate pour les correctifs de sécurité.)
<br><br>2. Maintenez une veille de sécurité :<br>
<br>
Abonnez-vous aux listes de diffusion des distributions utilisées :

<br><a data-tooltip-position="top" aria-label="https://lists.debian.org/debian-security-announce/" rel="noopener nofollow" class="external-link" href="https://lists.debian.org/debian-security-announce/" target="_blank">Debian Security Announcements</a>
<br><a data-tooltip-position="top" aria-label="https://lists.debian.org/debian-security-announce/" rel="noopener nofollow" class="external-link" href="https://lists.debian.org/debian-security-announce/" target="_blank">Ubuntu Security Annoucments</a>


<br>
Suivez les flux RSS du CERT-FR :

<br><a data-tooltip-position="top" aria-label="https://www.cert.ssi.gouv.fr/" rel="noopener nofollow" class="external-link" href="https://www.cert.ssi.gouv.fr/" target="_blank">CERT-FR Flux RSS</a>


<br>
Consultez les bases CVE (Common Vulnerabilities and Exposures) :

<br><a data-tooltip-position="top" aria-label="https://nvd.nist.gov/vuln" rel="noopener nofollow" class="external-link" href="https://nvd.nist.gov/vuln" target="_blank">NVD CVE Database</a>


<br><br>3. Identifier les mises à jour disponibles<br>
<br>Lister les mises à jour disponibles :
<br>sudo apt update
<br>
<br>Vérifier les mises à jour de sécurité :
<br>sudo apt install unattended-upgrades
sudo dpkg-reconfigure unattended-upgrades
<br><br>4. Automatiser les mises à jours<br>
<br>Planifier les mises à jours:
<br>echo "0 2 * * * root apt-get update &amp;&amp; apt-get -y upgrade" &gt; /etc/cron.d/auto-upgrades
<br><br><br>Avantages :<br>
<br>Réduction des vulnérabilités : Limite l’exposition aux attaques exploitant des failles connues.
<br>Facilité de gestion : Les mises à jour automatiques réduisent les efforts manuels.
<br>Conformité : Respecte les standards de sécurité recommandés (ISO 27001, RGPD).
<br>Limites :<br>
<br>Les mises à jour automatiques peuvent parfois causer des incompatibilités logicielles.
<br>Le redémarrage requis pour certains patchs peut perturber les services critiques.
<br>Effectuer des mises à jour régulières est une mesure fondamentale pour maintenir la sécurité des systèmes Linux. En combinant une veille proactive avec l’automatisation des mises à jour critiques, vous pouvez garantir un environnement à jour et réduire les risques liés aux vulnérabilités connues.]]></description><link>wiki\configuration-système\r61-effectuer-des-mises-à-jour-régulières.html</link><guid isPermaLink="false">Wiki/Configuration système/R61 - Effectuer des mises à jour régulières.md</guid><pubDate>Sun, 15 Dec 2024 23:05:42 GMT</pubDate></item><item><title><![CDATA[Sommaire - Configuration système]]></title><description><![CDATA[<a class="tag" href="?query=tag:Sudo" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Sudo</a> <a class="tag" href="?query=tag:Configuration_des_paquets" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Configuration_des_paquets</a> <a class="tag" href="?query=tag:Mot_de_passe" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Mot_de_passe</a> <a class="tag" href="?query=tag:Partitionnement" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Partitionnement</a> <a class="tag" href="?query=tag:Comptes_de_services" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Comptes_de_services</a> <a class="tag" href="?query=tag:Session_utilisateur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Session_utilisateur</a> <a class="tag" href="?query=tag:Gestion_des_droits" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Gestion_des_droits</a> <a class="tag" href="?query=tag:setuid_et_setgrid" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#setuid_et_setgrid</a> <a class="tag" href="?query=tag:Mise_à_jour" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Mise_à_jour</a> 
 <br><br>
<br><a data-href="R28 - Partitionnement type" href="wiki\configuration-système\r28-partitionnement-type.html" class="internal-link" target="_self" rel="noopener nofollow">R28 - Partitionnement type</a>
<br><a data-href="R30 - Désactiver les comptes utilisateur inutilisés" href="wiki\configuration-système\r30-désactiver-les-comptes-utilisateur-inutilisés.html" class="internal-link" target="_self" rel="noopener nofollow">R30 - Désactiver les comptes utilisateur inutilisés</a>
<br><a data-href="R31 - Utiliser des mots de passe robustes" href="wiki\configuration-système\r31-utiliser-des-mots-de-passe-robustes.html" class="internal-link" target="_self" rel="noopener nofollow">R31 - Utiliser des mots de passe robustes</a>
<br><a data-href="R32 - Expirer les sessions utilisateurs locales" href="wiki\configuration-système\r32-expirer-les-sessions-utilisateurs-locales.html" class="internal-link" target="_self" rel="noopener nofollow">R32 - Expirer les sessions utilisateurs locales</a>
<br><a data-href="R33 - Assurer l’imputabilité des actions d’administration" href="wiki\configuration-système\r33-assurer-l’imputabilité-des-actions-d’administration.html" class="internal-link" target="_self" rel="noopener nofollow">R33 - Assurer l’imputabilité des actions d’administration</a>
<br><a data-href="R34 - Désactiver les comptes de service" href="wiki\configuration-système\r34-désactiver-les-comptes-de-service.html" class="internal-link" target="_self" rel="noopener nofollow">R34 - Désactiver les comptes de service</a>
<br><a data-href="R35 - Utiliser des comptes de service uniques et exclusifs" href="wiki\configuration-système\r35-utiliser-des-comptes-de-service-uniques-et-exclusifs.html" class="internal-link" target="_self" rel="noopener nofollow">R35 - Utiliser des comptes de service uniques et exclusifs</a>
<br><a data-href="R39 - Modifier les directives de configuration `sudo`" href="wiki\configuration-système\r39-modifier-les-directives-de-configuration-`sudo`.html" class="internal-link" target="_self" rel="noopener nofollow">R39 - Modifier les directives de configuration `sudo`</a>
<br><a data-href="R40 - Utiliser des utilisateurs cibles non-privilégiés pour les commandes SUDO" href="wiki\configuration-système\r40-utiliser-des-utilisateurs-cibles-non-privilégiés-pour-les-commandes-sudo.html" class="internal-link" target="_self" rel="noopener nofollow">R40 - Utiliser des utilisateurs cibles non-privilégiés pour les commandes SUDO</a>
<br><a data-href="R42 - Bannir les négations dans les spécifications sudo" href="wiki\configuration-système\r42-bannir-les-négations-dans-les-spécifications-sudo.html" class="internal-link" target="_self" rel="noopener nofollow">R42 - Bannir les négations dans les spécifications sudo</a>
<br><a data-href="R53 - Eviter les fichiers ou répertoires sans utilisateur ou sans groupe connu" href="wiki\configuration-système\r53-eviter-les-fichiers-ou-répertoires-sans-utilisateur-ou-sans-groupe-connu.html" class="internal-link" target="_self" rel="noopener nofollow">R53 - Eviter les fichiers ou répertoires sans utilisateur ou sans groupe connu</a>
<br><a data-href="R54 - Activer le Sticky Bit sur les répertoires Inscriptibles" href="wiki\configuration-système\r54-activer-le-sticky-bit-sur-les-répertoires-inscriptibles.html" class="internal-link" target="_self" rel="noopener nofollow">R54 - Activer le Sticky Bit sur les répertoires Inscriptibles</a>
<br><a data-href="R56 - Eviter l'usage d'exécutablex avec les droits spéciaux setuid et setgrid" href="wiki\configuration-système\r56-eviter-l'usage-d'exécutablex-avec-les-droits-spéciaux-setuid-et-setgrid.html" class="internal-link" target="_self" rel="noopener nofollow">R56 - Eviter l'usage d'exécutablex avec les droits spéciaux setuid et setgrid</a>
<br><a data-href="R58 - N'installer que les paquets strictement nécessaires" href="wiki\configuration-système\r58-n'installer-que-les-paquets-strictement-nécessaires.html" class="internal-link" target="_self" rel="noopener nofollow">R58 - N'installer que les paquets strictement nécessaires</a>
<br><a data-href="R59 - Utiliser des dépôts de paquets de confiance" href="wiki\configuration-système\r59-utiliser-des-dépôts-de-paquets-de-confiance.html" class="internal-link" target="_self" rel="noopener nofollow">R59 - Utiliser des dépôts de paquets de confiance</a>
<br><a data-href="R59 - Utiliser des dépôts de paquets de confiance" href="wiki\configuration-système\r59-utiliser-des-dépôts-de-paquets-de-confiance.html" class="internal-link" target="_self" rel="noopener nofollow">R59 - Utiliser des dépôts de paquets de confiance</a>
<br><a data-href="R61 - Effectuer des mises à jour régulières" href="wiki\configuration-système\r61-effectuer-des-mises-à-jour-régulières.html" class="internal-link" target="_self" rel="noopener nofollow">R61 - Effectuer des mises à jour régulières</a>
<br><br>
<br><a href=".?query=tag:Sudo" class="tag" target="_blank" rel="noopener nofollow">#Sudo</a>
<br><a href=".?query=tag:Configuration_des_paquets" class="tag" target="_blank" rel="noopener nofollow">#Configuration_des_paquets</a>
<br><a href=".?query=tag:Mot_de_passe" class="tag" target="_blank" rel="noopener nofollow">#Mot_de_passe</a>
<br><a href=".?query=tag:Partitionnement" class="tag" target="_blank" rel="noopener nofollow">#Partitionnement</a>
<br><a href=".?query=tag:Comptes_de_services" class="tag" target="_blank" rel="noopener nofollow">#Comptes_de_services</a>
<br><a href=".?query=tag:Session_utilisateur" class="tag" target="_blank" rel="noopener nofollow">#Session_utilisateur</a>
<br><a href=".?query=tag:Gestion_des_droits" class="tag" target="_blank" rel="noopener nofollow">#Gestion_des_droits</a>
<br><a href=".?query=tag:setuid_et_setgrid" class="tag" target="_blank" rel="noopener nofollow">#setuid_et_setgrid</a>
<br><a href=".?query=tag:Mise_à_jour" class="tag" target="_blank" rel="noopener nofollow">#Mise_à_jour</a>
<br>]]></description><link>wiki\configuration-système\sommaire-configuration-système.html</link><guid isPermaLink="false">Wiki/Configuration système/Sommaire - Configuration système.md</guid><pubDate>Sun, 15 Dec 2024 23:06:50 GMT</pubDate></item><item><title><![CDATA[Index]]></title><description><![CDATA[<a class="tag" href="?query=tag:M" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#M</a> <a class="tag" href="?query=tag:MI" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MI</a> <a class="tag" href="?query=tag:MIR" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIR</a> <a class="tag" href="?query=tag:MIRE" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#MIRE</a> <a class="tag" href="?query=tag:Minimisation" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Minimisation</a> <a class="tag" href="?query=tag:Moindre_privilège" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Moindre_privilège</a> <a class="tag" href="?query=tag:Défense_en_profondeur" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Défense_en_profondeur</a> <a class="tag" href="?query=tag:Veille_et_maintenance" style="background-color: rgb(4, 108, 116); color: white; font-weight: 700; border: none; border-radius: 1em; padding: 0.2em 0.5em;">#Veille_et_maintenance</a> 
 <br>Ce wiki vise à lister un certain nombre de mesures utiles au durcissement d'un Linux. Chaque entrée devrait être accompagnée d'un bref rappel de l'objectif, d'une procédure de mise en place, de sources utiles et complémentaires ainsi que de commentaires quand nécessaire.<br>Les entrées sont réparties sont classées selon le schéma MIRE de l'ANSSI, et chacune également affiliée à un grand principe de la cybersécurité. La présence de tags peut simplifier la recherche transversale des pages souhaitées.<br><br><br>
<br><a data-href="Sommaire - Configuration matérielle" href="wiki\configuration-matérielle\sommaire-configuration-matérielle.html" class="internal-link" target="_self" rel="noopener nofollow">Sommaire - Configuration matérielle</a>
<br><a data-href="Sommaire - Configuration noyau" href="wiki\configuration-noyau\sommaire-configuration-noyau.html" class="internal-link" target="_self" rel="noopener nofollow">Sommaire - Configuration noyau</a>
<br><a data-href="Sommaire - Configuration système" href="wiki\configuration-système\sommaire-configuration-système.html" class="internal-link" target="_self" rel="noopener nofollow">Sommaire - Configuration système</a>
<br><a data-href="Sommaire - Configuration des services" href="wiki\configuration-des-services\sommaire-configuration-des-services.html" class="internal-link" target="_self" rel="noopener nofollow">Sommaire - Configuration des services</a>
<br><br><br>Par importance :<br>
- <a href=".?query=tag:M" class="tag" target="_blank" rel="noopener nofollow">#M</a><br>
- <a href=".?query=tag:MI" class="tag" target="_blank" rel="noopener nofollow">#MI</a><br>
- <a href=".?query=tag:MIR" class="tag" target="_blank" rel="noopener nofollow">#MIR</a><br>
- <a href=".?query=tag:MIRE" class="tag" target="_blank" rel="noopener nofollow">#MIRE</a><br>
Par principes :<br>
- <a href=".?query=tag:Minimisation" class="tag" target="_blank" rel="noopener nofollow">#Minimisation</a><br>
- <a href=".?query=tag:Moindre_privilège" class="tag" target="_blank" rel="noopener nofollow">#Moindre_privilège</a><br>
- <a href=".?query=tag:Défense_en_profondeur" class="tag" target="_blank" rel="noopener nofollow">#Défense_en_profondeur</a><br>
- <a href=".?query=tag:Veille_et_maintenance" class="tag" target="_blank" rel="noopener nofollow">#Veille_et_maintenance</a><br><br><br>Thomas P.<br>
Titouan L.<br>
Titouan J.]]></description><link>wiki\index.html</link><guid isPermaLink="false">Wiki/Index.md</guid><pubDate>Sun, 15 Dec 2024 22:24:58 GMT</pubDate></item></channel></rss>